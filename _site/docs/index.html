<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<title>Raincatcher Introduction</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:initial}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px 0}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:.4em .75em 0 .75em;line-height:1;vertical-align:top}
.colist>table tr>td:first-of-type img{max-width:initial}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<!-- Generate a nice TOC -->
<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js"></script>
<!-- We do not need the tocify CSS because the asciidoc CSS already provides most of what we neeed -->

<style>
.tocify-header {
    font-style: italic;
}

.tocify-subheader {
    font-style: normal;
    font-size: 90%;
}

.tocify ul {
    margin: 0;
 }

.tocify-focus {
    color: #7a2518;
    background-color: rgba(0, 0, 0, 0.1);
}

.tocify-focus > a {
    color: #7a2518;
}
</style>

<script type="text/javascript">
    $(function () {
        // Add a new container for the tocify toc into the existing toc so we can re-use its
        // styling
        $("#toc").append("<div id='generated-toc'></div>");
        $("#generated-toc").tocify({
            extendPage: true,
            context: "#content",
            highlightOnScroll: true,
            hideEffect: "slideUp",
            // Use the IDs that asciidoc already provides so that TOC links and intra-document
            // links are the same. Anything else might confuse users when they create bookmarks.
            hashGenerator: function(text, element) {
                return $(element).attr("id");
            },
            // Smooth scrolling doesn't work properly if we use the asciidoc IDs
            smoothScroll: false,
            // Set to 'none' to use the tocify classes
            theme: "none",
            // Handle book (may contain h1) and article (only h2 deeper)
            selectors: $( "#content" ).has( "h1" ).size() > 0 ? "h1,h2,h3,h4,h5" : "h2,h3,h4,h5",
            ignoreSelector: ".discrete"
        });

        // Switch between static asciidoc toc and dynamic tocify toc based on browser size
        // This is set to match the media selectors in the asciidoc CSS
        // Without this, we keep the dynamic toc even if it is moved from the side to preamble
        // position which will cause odd scrolling behavior
        var handleTocOnResize = function() {
            if ($(document).width() < 768) {
                $("#generated-toc").hide();
                $(".sectlevel0").show();
                $(".sectlevel1").show();
            }
            else {
                $("#generated-toc").show();
                $(".sectlevel0").hide();
                $(".sectlevel1").hide();
            }
        }

        $(window).resize(handleTocOnResize);
        handleTocOnResize();
    });
</script>
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#raincatcher">Raincatcher Introduction</a>
<ul class="sectlevel1">
<li><a href="#{context}-con-introducing-raincatcher">1. RainCatcher 1.0.0</a>
<ul class="sectlevel2">
<li><a href="#_goals">1.1. Goals</a></li>
<li><a href="#_process_management">1.2. Process Management</a>
<ul class="sectlevel3">
<li><a href="#_process_management_overview">1.2.1. Process Management overview</a></li>
</ul>
</li>
<li><a href="#{context}-ref-introducing-raincatcher">1.3. RainCatcher Reference Material</a>
<ul class="sectlevel3">
<li><a href="#{context}-highlighting-raincatcher-areas-of-focus">1.3.1. Highlighting RainCatcher Areas of Focus</a></li>
<li><a href="#{context}-raincatcher-at-a-technical-level">1.3.2. RainCatcher at a Technical Level</a></li>
<li><a href="#{context}-identifying-raincatcher-repositories">1.3.3. Identifying RainCatcher Repositories</a></li>
<li><a href="#{context}-differentiating-raincatcher-from-tech-preview">1.3.4. Differentiating RainCatcher from 'Tech Preview'</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#getting-started">Getting Started with the RainCatcher Applications</a>
<ul class="sectlevel1">
<li><a href="#{context}-pro-running-the-demo-repositories">2. Running the RainCatcher Applications on a Local Machine</a>
<ul class="sectlevel2">
<li><a href="#_credentials_for_the_portal_and_mobile_applications">2.1. Credentials for the Portal and Mobile Applications</a></li>
</ul>
</li>
<li><a href="#{context}-pro-using-the-demo-app">3. Learning to Use Workflows and Workorders</a>
<ul class="sectlevel2">
<li><a href="#_working_with_the_portal_application">3.1. Working with the Portal Application</a></li>
<li><a href="#_working_with_the_mobile_application">3.2. Working with the Mobile Application</a></li>
<li><a href="#{context}-ref-demo-app">3.3. RainCatcher Application Reference Material</a>
<ul class="sectlevel3">
<li><a href="#{context}-credentials-for-the-mobile-and-portal-demo-application">3.3.1. Credentials for the Mobile and Portal Application</a></li>
<li><a href="#{context}-structure-for-the-mobile-and-portal-starter-applications">3.3.2. Structure for the Mobile and Portal Starter Applications</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#building-wfm-process">Building a Workflow</a>
<ul class="sectlevel1">
<li><a href="#{context}-con-workflow-step">4. Building Your First Workflow Step</a>
<ul class="sectlevel2">
<li><a href="#_structure_of_a_step">4.1. Structure of a Step</a>
<ul class="sectlevel3">
<li><a href="#_module">4.1.1. Module</a></li>
<li><a href="#_definition">4.1.2. Definition</a></li>
</ul>
</li>
<li><a href="#_creating_new_step_package">4.2. Creating new Step Package</a>
<ul class="sectlevel3">
<li><a href="#_raincatcher_step_generator">4.2.1. RainCatcher Step Generator</a></li>
<li><a href="#_template">4.2.2. Template</a></li>
<li><a href="#_modifications">4.2.3. Modifications</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#{context}-con-packaged-step">5. RainCatcher's Packaged-Steps</a>
<ul class="sectlevel2">
<li><a href="#_the_signature_step">5.1. The Signature Step</a></li>
<li><a href="#_packaged_step_roadmap">5.2. Packaged-Step Roadmap</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#top-level-apps-overview">Top Level Applications Overview</a>
<ul class="sectlevel1">
<li><a href="#{context}-con-wfm">6. Understanding the <strong>RainCatcher</strong> Application</a></li>
<li><a href="#{context}-con-wfm-supported-modules">7. RainCatcher Supported Modules</a></li>
<li><a href="#{context}-ref-mobile">8. Mobile Application</a>
<ul class="sectlevel2">
<li><a href="#_running_on_a_browser">8.1. Running on a browser</a></li>
<li><a href="#_repository_structure">8.2. Repository Structure</a></li>
<li><a href="#_running_on_a_device_emulator">8.3. Running on a Device Emulator</a></li>
</ul>
</li>
<li><a href="#{context}-ref-portal">9. Portal Application</a>
<ul class="sectlevel2">
<li><a href="#_running_on_a_browser_2">9.1. Running on a browser</a></li>
<li><a href="#_repository_structure_2">9.2. Repository Structure</a></li>
</ul>
</li>
<li><a href="#{context}-ref-server">10. Server Application</a>
<ul class="sectlevel2">
<li><a href="#_raincatcher_server">10.1. RainCatcher Server</a></li>
<li><a href="#_server_side_application_development_guide">10.2. Server-side Application Development Guide</a>
<ul class="sectlevel3">
<li><a href="#_prerequisites_for_a_local_environment">10.2.1. Prerequisites for a Local Environment</a></li>
<li><a href="#_server_side_configuration">10.2.2. Server-side Configuration</a></li>
<li><a href="#_structure">10.2.3. Structure</a></li>
<li><a href="#_configuring_custom_query_parameters_for_mobile_clients">10.2.4. Configuring Custom Query Parameters for Mobile Clients</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#integrations">RainCatcher Integrations</a>
<ul class="sectlevel1">
<li><a href="#_sync">11. Sync</a>
<ul class="sectlevel2">
<li><a href="#{context}-con-datasync">11.1. Introducing the RainCatcher Datasync Module</a>
<ul class="sectlevel3">
<li><a href="#{context}-datasync-cloud-module">11.1.1. Datasync Cloud</a></li>
<li><a href="#{context}-datasync-client-module">11.1.2. Datasync Client</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_security_introduction">12. Security introduction</a>
<ul class="sectlevel2">
<li><a href="#{context}-con-introducing-securityfeatures">12.1. Introducing RainCatcher Security Features</a>
<ul class="sectlevel3">
<li><a href="#_authorization_using_the_security_interface">12.1.1. Authorization using the Security Interface</a></li>
<li><a href="#_introducing_passport_js">12.1.2. Introducing Passport.js</a></li>
<li><a href="#_introducing_keycloak">12.1.3. Introducing Keycloak</a></li>
<li><a href="#_choosing_passport_js_or_keycloak">12.1.4. Choosing Passport.js or Keycloak</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_using_keycloak">13. Using Keycloak</a>
<ul class="sectlevel2">
<li><a href="#{context}-con-keycloak">13.1. Introducing Keycloak within RainCatcher</a>
<ul class="sectlevel3">
<li><a href="#{context}-ref-keycloak-material">13.1.1. Keycloak Reference Material</a></li>
</ul>
</li>
<li><a href="#{context}-con-keycloak-securitystrategy">13.2. Introducing the Security Strategy for Keycloak</a>
<ul class="sectlevel3">
<li><a href="#{context}-ref-keycloak-securitystrategy">13.2.1. Defining the Security Strategy for RainCatcher Keycloak</a></li>
</ul>
</li>
<li><a href="#{context}-pro-keycloak-enablement">13.3. Enabling Keycloak</a>
<ul class="sectlevel3">
<li><a href="#_prerequisites_4">13.3.1. Prerequisites</a></li>
<li><a href="#{context}-run-keycloak-docker-image">13.3.2. Running the Keycloak Docker Image</a></li>
<li><a href="#{context}-setup-keycloak-realm">13.3.3. Setting up a Keycloak Realm</a></li>
<li><a href="#{context}-adding-keycloak-configuration">13.3.4. Adding Keycloak Configuration</a></li>
<li><a href="#{context}-enabling-keycloak-on-the-server">13.3.5. Enabling Keycloak on the RainCatcher Applications</a></li>
<li><a href="#{context}-accessing-the-keycloak-admin-console">13.3.6. Accessing the Keycloak Admin Console</a></li>
<li><a href="#{context}-keycloak-configuration-production">13.3.7. Keycloak Configuration for Production Environments</a></li>
</ul>
</li>
<li><a href="#{context}-pro-keycloak-implementation">13.4. Implementing Keycloak</a>
<ul class="sectlevel3">
<li><a href="#_prerequisites_5">13.4.1. Prerequisites</a></li>
<li><a href="#_using_keycloak_to_secure_express_endpoints">13.4.2. Using Keycloak to secure Express endpoints</a></li>
<li><a href="#{context}-implement-endpointsecurity-interface">13.4.3. Implement the EndpointSecurity Interface</a></li>
<li><a href="#{context}-enable-keycloak-security-middleware">13.4.4. Enable Keycloak Security Middleware for Route Protection</a></li>
<li><a href="#{context}-protect-express-routes">13.4.5. Protect Express Routes</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_using_passport_js">14. Using Passport.js</a>
<ul class="sectlevel2">
<li><a href="#{context}-con-passportauth-module">14.1. Introducing the RainCatcher PassportAuth Module</a></li>
<li><a href="#{context}-con-passportauth-securitystrategy">14.2. Introducing the Security Strategy for PassportAuth</a>
<ul class="sectlevel3">
<li><a href="#{context}-ref-passportauth-securitystrategy">14.2.1. Defining the Security Strategy for RainCatcher PassportAuth</a></li>
</ul>
</li>
<li><a href="#{context}pro-passportauth-enablement">14.3. Enabling PassportAuth</a>
<ul class="sectlevel3">
<li><a href="#_prerequisites_6">14.3.1. Prerequisites</a></li>
<li><a href="#_enabling_passportauth_on_the_raincatcher_applications">14.3.2. Enabling PassportAuth on the RainCatcher Applications</a></li>
</ul>
</li>
<li><a href="#{context}-pro-passportauth-implementation">14.4. Implementing PassportAuth</a>
<ul class="sectlevel3">
<li><a href="#_prerequisites_7">14.4.1. Prerequisites</a></li>
<li><a href="#{context}-pro-passportauth-pointing-to-a-datasource">14.4.2. Pointing PassportAuth to a Datasource</a></li>
<li><a href="#{context}-enable-passportauth">14.4.3. Enable PassportAuth for Route Protection</a></li>
<li><a href="#{context}-passportauth-protect-routes">14.4.4. Using the PassportAuth Middleware for Route Protection</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_logging">Logging</a></li>
<li><a href="#ui">Modifying the UI</a>
<ul class="sectlevel1">
<li><a href="#{context}-ref-ui-technology">15. The Technology and Structure of the User Interface in a RainCatcher Project</a>
<ul class="sectlevel2">
<li><a href="#_ui_frameworks">15.1. UI Frameworks</a></li>
<li><a href="#_styling">15.2. Styling</a></li>
<li><a href="#_mobile_app_tooling">15.3. Mobile app tooling</a></li>
</ul>
</li>
<li><a href="#{context}-con-extending-the-user-interface">16. Extending the User Interface</a>
<ul class="sectlevel2">
<li><a href="#_extending_the_workorders_ui">16.1. Extending the Workorders UI</a>
<ul class="sectlevel3">
<li><a href="#_building_directives">16.1.1. Building Directives</a></li>
</ul>
</li>
<li><a href="#_user_interface">16.2. User Interface</a></li>
<li><a href="#_development_of_a_template">16.3. Development of a template</a></li>
<li><a href="#_integration">16.4. Integration</a></li>
<li><a href="#_publishing">16.5. Publishing</a></li>
</ul>
</li>
<li><a href="#{context}-pro-ui-customization">17. RainCatcher UI App Customization</a>
<ul class="sectlevel2">
<li><a href="#{context}-adding-ui-elements">17.1. Adding UI elements</a>
<ul class="sectlevel3">
<li><a href="#{context}-create-angularjs-module">17.1.1. Creating your own AngularJS module with routing</a></li>
<li><a href="#{context}-add-custom-module">17.1.2. Adding the new module to the main application config</a></li>
<li><a href="#_new_navigation_option_on_the_navigation_sidebar">17.1.3. New navigation option on the navigation sidebar</a></li>
</ul>
</li>
<li><a href="#_customizing_sass_and_themes">17.2. Customizing SASS and Themes</a>
<ul class="sectlevel3">
<li><a href="#_adding_extra_stylesheets">17.2.1. Adding extra Stylesheets</a></li>
<li><a href="#_changing_the_theme_of_raincatcher_components">17.2.2. Changing the theme of RainCatcher components</a></li>
</ul>
</li>
<li><a href="#_customizing_raincatcher_login_ui">17.3. Customizing RainCatcher Login UI</a>
<ul class="sectlevel3">
<li><a href="#{context}-customizing-passportauth-login-ui">17.3.1. Customizing PassportAuth Login UI</a></li>
<li><a href="#_customizing_keycloak_login_ui">17.3.2. Customizing Keycloak Login UI</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_raincatcher_angularjs_modules">18. RainCatcher AngularJS modules</a></li>
</ul>
</li>
<li><a href="#performance">Production setup</a>
<ul class="sectlevel1">
<li><a href="#{context}-production-checklist">19. Production checklist</a>
<ul class="sectlevel2">
<li><a href="#_server_configuration">19.1. Server configuration</a></li>
<li><a href="#_mobile_application">19.2. Mobile application</a>
<ul class="sectlevel3">
<li><a href="#_cordova_configuration">19.2.1. Cordova configuration</a></li>
</ul>
</li>
<li><a href="#_portal_configuration">19.3. Portal configuration</a></li>
<li><a href="#_remove_redundant_code_from_all_applications">19.4. Remove redundant code from all applications</a></li>
</ul>
</li>
<li><a href="#{context}-performance-guidelines">20. Performance Guidelines</a>
<ul class="sectlevel2">
<li><a href="#_purpose_of_this_guide">20.1. Purpose of this guide</a></li>
<li><a href="#_server_application">20.2. Server application</a>
<ul class="sectlevel3">
<li><a href="#_mongodb">20.2.1. MongoDB</a></li>
<li><a href="#_indexes_on_the_mongodb_data">20.2.2. Indexes on the mongodb data</a></li>
<li><a href="#_redis_cache">20.2.3. Redis Cache</a></li>
<li><a href="#_passport_js">20.2.4. Passport.js</a></li>
<li><a href="#_feedhenry_sync">20.2.5. FeedHenry Sync</a></li>
</ul>
</li>
<li><a href="#_keycloak_sso_authentication">20.3. Keycloak/SSO authentication</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#release-notes">Release notes</a>
<ul class="sectlevel1">
<li><a href="#_overview">21. Overview</a>
<ul class="sectlevel2">
<li><a href="#_1_1_0_release">21.1. 1.1.0 Release</a>
<ul class="sectlevel3">
<li><a href="#_starting_the_applications">21.1.1. Starting the applications</a></li>
</ul>
</li>
<li><a href="#_1_0_0_release">21.2. 1.0.0 Release</a>
<ul class="sectlevel3">
<li><a href="#_workflows">21.2.1. Workflows</a></li>
<li><a href="#_workorders">21.2.2. Workorders</a></li>
<li><a href="#_step_generator">21.2.3. Step Generator</a></li>
<li><a href="#_packaged_step">21.2.4. Packaged Step</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#Contributing">Contributing</a>
<ul class="sectlevel1">
<li><a href="#{context}-pro-contributing-guide">22. Contributing Guide</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="https://raw.githubusercontent.com/feedhenry-raincatcher/raincatcher-docs/master/docs/shared/images/logo-blue.png" alt="logo">
</div>
</div>
</div>
</div>
<h1 id="raincatcher" class="sect0">Raincatcher Introduction</h1>
<div class="sect1">
<h2 id="{context}-con-introducing-raincatcher">1. RainCatcher 1.0.0</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RainCatcher is a Workforce Management Platform.</p>
</div>
<div class="paragraph">
<p>RainCatcher allows you to move from paper based forms and processes into complete mobile enabled solution.
RainCatcher connects an organization&#8217;s back-office with its fleet of mobilized employees by providing two fully customizable applications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Mobile worker (operator) application</p>
</li>
<li>
<p>Management Portal (back office) application</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Both applications are utilizing Node.js based server through RESTful api.</p>
</div>
<div class="sect2">
<h3 id="_goals">1.1. Goals</h3>
<div class="paragraph">
<p>The primary goal of RainCatcher is to minimize development effort required to build WFM applications. It achieves that by providing set of modules that can be integrated into existing applications.
Developers can effectively reuse them in their applications or base on RainCatcher reference applications that integrate all modules into fully functional solution. RainCatcher targets to satisfy requirements that each production website and mobile application needs.
In particular:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Mobile development (using Apache Cordova plugins)</p>
</li>
<li>
<p>Real-time Data Access and synchronization</p>
</li>
<li>
<p>Authentication and Authorization (using multiple providers)</p>
</li>
<li>
<p>Security (using best patterns for mobile and website security)</p>
</li>
<li>
<p>Logging (tracing issues out of the box)</p>
</li>
<li>
<p>User interface (AngularJS based interface that can be customized)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It allows developers to leverage production hardened applications by extending them to suit their business needs. Each application can be customized by writing or reusing one of the available RainCatcher modules.</p>
</div>
<div class="paragraph">
<p>RainCatcher separates modules into different categories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Core modules containing main functionality (@raincatcher/*)</p>
<div class="ulist">
<ul>
<li>
<p>Client modules used in mobile and portal applications</p>
</li>
<li>
<p>Server modules to be used only in server application</p>
</li>
</ul>
</div>
</li>
<li>
<p>User interface modules  (@raincatcher/angularjs-*)</p>
</li>
<li>
<p>Step modules (@raincatcher/step-*)</p>
</li>
<li>
<p>Example step modules (@raincatcher-examples/*)</p>
</li>
<li>
<p>External modules build by RainCatcher users and custom code in reference applications</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="/docs/images/diagrams/customSolution.png" alt="customSolution">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_process_management">1.2. Process Management</h3>
<div class="paragraph">
<p>RainCatcher focuses mainly on digitalizing business process
by including set of the modules responsible for the process management to the user applications.</p>
</div>
<div class="paragraph">
<p>Main features of the Process Management modules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creation customizable processes (called workflows)</p>
</li>
<li>
<p>Creation of process instances called workorders</p>
</li>
<li>
<p>Creation workflows using steps</p>
</li>
<li>
<p>Providing customization to the process using step definitions</p>
</li>
<li>
<p>Integrating workflows and workorders into the mobile application</p>
</li>
<li>
<p>Providing number of predefined steps that can be used for any business needs</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Process Management framework can be extended by <em>Step Definitions</em> which are responsible for wrapping business processes into single reusable units. For more technical information about <em>Step Definitions</em> please refer to the Process Management Guide.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/docs/images/diagrams/referenceflow.png" alt="referenceFlow">
</div>
</div>
<div class="sect3">
<h4 id="_process_management_overview">1.2.1. Process Management overview</h4>
<div class="paragraph">
<p>Developers can extend RainCatcher solution by providing <em>Step Definitions</em>. Are provided as one more more npm modules that needs to be added to both mobile and portal applications. All included steps will be available as library that can be accessed and used to build workflows in end user applications.</p>
</div>
<div class="paragraph">
<p>Portal administrators can build <code>workflows</code> which containing ordered <code>Steps</code> that each mobile operator needs to complete.</p>
</div>
<div class="paragraph">
<p><code>Workflows</code> can be instantiated as <code>Workorders</code> which will contain specific details and be assigned one of the field operators.
Once workorder is created it will be populated in the mobile field operator application.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/docs/images/diagrams/overview.png" alt="overview">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="{context}-ref-introducing-raincatcher">1.3. RainCatcher Reference Material</h3>
<div class="sect3">
<h4 id="{context}-highlighting-raincatcher-areas-of-focus">1.3.1. Highlighting RainCatcher Areas of Focus</h4>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Areas of Focus</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Area</th>
<th class="tableblock halign-left valign-top">Focus</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Framework</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A generic and developer friendly framework (set of classes) for building mobile and website Workforce Management solutions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Modules</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Modules specific to RainCatcher, for example: signature-module, scheduler</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrations to satisfy RainCatcher needs, for example: authentication, storage, offline capabilities, server side synchronization</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User Interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphical User Interfaces are implemented in AngularJS and Angular</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="{context}-raincatcher-at-a-technical-level">1.3.2. RainCatcher at a Technical Level</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://nodejs.org/en/">Node.js</a> used for server side code</p>
</li>
<li>
<p>Hybrid mobile development using <a href="https://cordova.apache.org/">Cordova</a></p>
</li>
<li>
<p>Object Oriented approach (classes and interfaces)</p>
</li>
<li>
<p>Focus on module reuse and flexibility</p>
</li>
<li>
<p>Incorporates open-source technologies: MongoDb, Keycloak, Passport.js and others.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="{context}-identifying-raincatcher-repositories">1.3.3. Identifying RainCatcher Repositories</h4>
<div class="paragraph">
<p>RainCatcher is available in three github repositories:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. RainCatcher Repositories</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Repository</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/feedhenry-raincatcher/raincatcher-mobile">raincatcher-mobile</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains the Mobile application.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/feedhenry-raincatcher/raincatcher-portal">raincatcher-portal</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains the Portal application.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/feedhenry-raincatcher/raincatcher-server">raincatcher-server</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains the Server application.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/feedhenry-raincatcher/raincatcher-docs">raincatcher-docs</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Repository contains <strong>RainCatcher</strong> documentation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/feedhenry-raincatcher/raincatcher-core">raincatcher-core</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains the contribution repository of the supported modules and server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/feedhenry-raincatcher/raincatcher-angularjs">raincatcher-angularjs</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains the contribution repository angularJS user interface for the mobile and portal</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="{context}-differentiating-raincatcher-from-tech-preview">1.3.4. Differentiating RainCatcher from 'Tech Preview'</h4>
<div class="paragraph">
<p>The <strong>RainCatcher</strong> project was originally called <strong>Tech Preview</strong>.
The <strong>Tech Preview</strong> codebase is now deprecated and is accessible at <a href="https://github.com/feedhenry-raincatcher/raincatcher-documentation">Tech Preview Documentation</a>.
The main differences between <strong>RainCatcher</strong> and <strong>Tech Preview</strong> are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Mediator pattern is removed from <strong>RainCatcher</strong></p>
</li>
<li>
<p><strong>Tech Preview</strong> is not object oriented</p>
</li>
<li>
<p><strong>RainCatcher</strong> is written in Typescript</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<h1 id="getting-started" class="sect0">Getting Started with the RainCatcher Applications</h1>
<div class="sect1">
<h2 id="{context}-pro-running-the-demo-repositories">2. Running the RainCatcher Applications on a Local Machine</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Get started by running RainCatcher applications on your local machine. Follow
these steps and use the <em>public NPM Registry</em> to set up the RainCatcher
applications that contain sample Steps, Workflows, and Workorders.</p>
</div>
<h3 id="_prerequisites" class="discrete">Prerequisites</h3>
<div class="paragraph">
<p>The following must be installed on your system:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Node and npm (tested version: 6 LTS)</p>
</li>
<li>
<p>git</p>
</li>
<li>
<p>MongoDB</p>
</li>
<li>
<p>Redis</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You must have access to GitHub to install the RainCatcher applications.</p>
</div>
<h3 id="{context}-published-repositories-cloning-the-git-repositories" class="discrete">Cloning the Git Repositories</h3>
<div class="paragraph">
<p>The following commands will clone the <code>master</code> branch of each repository and they collectively contain the latest tagged release of the RainCatcher project.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">git clone git@github.com:feedhenry-raincatcher/raincatcher-server.git
git clone git@github.com:feedhenry-raincatcher/raincatcher-mobile.git
git clone git@github.com:feedhenry-raincatcher/raincatcher-portal.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Previous versions are available through branches named with the <code>release-{semver}</code> convention.
For example, in order to checkout version <code>0.0.1</code> of <code>raincatcher-server</code>, run the following commands after the cloning:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">cd raincatcher-server/
git checkout release-0.0.1</code></pre>
</div>
</div>
<h3 id="{context}-published-repositories-installing-repository-dependencies" class="discrete">Installing Repository Dependencies</h3>
<div class="paragraph">
<p>For each repository previously cloned, run <code>npm install</code> so regular NPM dependencies are downloaded.</p>
</div>
<h3 id="{context}-published-repositories-starting-mongodb-and-redis" class="discrete">Starting MongoDB and Redis</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start MongoDB. For more information, see <a href="https://docs.mongodb.com/manual/tutorial/manage-mongodb-processes/#start-mongod-processes">Start MongoDB Processes</a>.</p>
</li>
<li>
<p>Start Redis. For more information, see <a href="https://redis.io/topics/quickstart#starting-redis">Starting Redis</a>.</p>
</li>
</ol>
</div>
<h3 id="{context}-published-repositories-starting-the-core-server" class="discrete">Starting the Core Server</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">cd raincatcher-server/
npm run start:ts</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The terminal is out of use while the Core Server is running.
</td>
</tr>
</table>
</div>
<h3 id="{context}-published-repositories-running-the-mobile-and-portal-applications" class="discrete">Running the Mobile and Portal Applications</h3>
<div class="paragraph">
<p>Open a new terminal and execute the following command in folder <code>raincatcher-portal/</code> and also in folder <code>raincatcher-mobile/</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">npm run start</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both the Mobile and Portal Applications open automatically in a browser.</p>
</div>
<div class="sect2">
<h3 id="_credentials_for_the_portal_and_mobile_applications">2.1. Credentials for the Portal and Mobile Applications</h3>
<div class="paragraph">
<p>The Portal and Mobile applications contain sample Steps, Workflows, and
Workorders for demonstration purposes. You can log in to the Portal and Mobile
applications with the following credentials to work with the sample content:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Application</th>
<th class="tableblock halign-left valign-top">Username</th>
<th class="tableblock halign-left valign-top">Password</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Portal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>max</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>123</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mobile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>trever</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>123</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For all available users, see: <a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/src/modules/passport-auth/users.json">users.json</a></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Users are valid for both passport and Keycloak auth providers.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As a next step, you can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the sample Workflows and Workorders. See <a href="#{context}-pro-using-the-demo-app">Learn to Use Workflows and Workorders</a>.</p>
</li>
<li>
<p>Create your own business logic. See the <a href="#building-wfm-process">Building a Workflow</a>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="{context}-pro-using-the-demo-app">3. Learning to Use Workflows and Workorders</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RainCatcher applications streamline process management with reusable objects
called <em>Workflows</em> and <em>Workorders</em>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <em>Workflow</em> is a set of steps that end users follow to complete a process.
Administrators create <em>Workflows</em> with the Portal application.</p>
</li>
<li>
<p>A <em>Workorder</em> is an instantiation of a <em>Workflow</em> that contains specific details.
Administrators can assign <em>Workorders</em> to end users. End users access
<em>Workorders</em> in the Mobile application.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the following section, you can use the sample content in the RainCatcher
applications running on your local machine.</p>
</div>
<div class="sect2">
<h3 id="_working_with_the_portal_application">3.1. Working with the Portal Application</h3>
<div class="paragraph">
<p>The <strong>Portal Application</strong> is used by an administrator to essentially manage the <em>Workorder</em>.</p>
</div>
<h4 id="_prerequisites_2" class="discrete">Prerequisites</h4>
<div class="paragraph">
<p>Ensure you have:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access to the Portal Application</p>
</li>
</ul>
</div>
<h4 id="{context}-importing-the-endpointsecurity-interface" class="discrete">Creating a Workflow</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Login as an administrator to the Portal Application</p>
</li>
<li>
<p>In the navigation panel on the left, click <strong>Workflow</strong></p>
</li>
<li>
<p>To create a new <em>Workflow</em>, click <strong>NEW Workflow</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>This will bring you to the <em>Create Workflow screen</em></p>
</li>
</ol>
</div>
</li>
<li>
<p>Add a title to the <em>Workflow</em></p>
</li>
<li>
<p>Click <strong>CREATE Workflow</strong> to navigate to the <em>Add Step screen</em></p>
<div class="imageblock">
<div class="content">
<img src="/docs/images/create-workflow.png" alt="creating a Workflow">
</div>
</div>
</li>
<li>
<p>Give the <em>Step</em> a name and then select a <em>Step Type</em> from the list</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>All <em>Steps</em>, default and custom, will appear in this list</p>
</li>
</ol>
</div>
</li>
<li>
<p>To submit the new <em>Step</em> to the <em>Workflow</em>, click <strong>ADD STEP</strong></p>
<div class="imageblock">
<div class="content">
<img src="/docs/images/workflow-nextstep.png" alt="Next Step Workflow">
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Use the <em>Add Step screen</em> to add additional steps to the <em>Workflow</em>.
</td>
</tr>
</table>
</div>
<h4 id="{context}-working-with-a-workflow" class="discrete">Working with a Workflow</h4>
<div class="paragraph">
<p>To make updates to a <em>Workflow</em> or to delete a <em>Workflow</em>, use the the <strong>pencil</strong> (to update) or the <strong>trash</strong> (to delete) icons in the top right side of the screen.
Updating a <em>Workflow</em> will increment the version of the <em>Workflow</em> however, do note that any existing <em>Workorders</em> that are based on the original <em>Workflow</em> will continue to use the older version of the <em>Workorder</em>.
Naturally, a new <em>Workorder</em> can be created and based on the incremented <em>Workflow</em>.</p>
</div>
<div class="paragraph">
<p>A <em>Step</em> can be modified or deleted.
Use the <strong>circle</strong> with the plus icon to create a new <em>Workflow</em>.
This new <em>Workflow</em> can be used to create or update <em>Workorders</em>.</p>
</div>
<div class="paragraph">
<p>Refresh the screen to see the new <em>Workflow</em> appearing in the list in the center panel.
You can access existing <em>Workflows</em> by selecting them in the list in the center panel.
The options presented for editing a <em>Workflow</em> are the same for the creation of a <em>Workflow</em>.</p>
</div>
<h4 id="{context}-creating-a-workorder" class="discrete">Creating a Workorder</h4>
<div class="paragraph">
<p>A <em>Workorder</em> is an individual instance of a <em>Workflow</em> and it can be assigned to an end user.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Login as an administrator to the Portal Application</p>
</li>
<li>
<p>In the navigation panel on the left, click <strong>Workorder</strong></p>
</li>
<li>
<p>To create a new <em>Workorder</em>, click <strong>NEW Workorder</strong> to open a form for completion</p>
<div class="imageblock">
<div class="content">
<img src="/docs/images/create-workorder.png" alt="Creating a Workorder">
</div>
</div>
</li>
<li>
<p>Add data to the form and when complete, click <code>CREATE Workorder</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Once the <em>Workorder</em> is created, it will sync with an end user&#8217;s account and is now accessible on the Mobile Application</p>
</li>
</ol>
</div>
</li>
<li>
<p>The page will refresh and the new <em>Workorder</em> will appear in the list on the middle panel</p>
</li>
<li>
<p>To edit a <em>Workorder</em> assigned to an individual end user, select the <em>Workorder</em> from the center panel list</p>
<div class="imageblock">
<div class="content">
<img src="/docs/images/portal-viewWorkorder.png" alt="view Workorder">
</div>
</div>
</li>
</ol>
</div>
<h4 id="{context}-working-with-a-workorder" class="discrete">Working with a Workorder</h4>
<div class="paragraph">
<p>To update a <em>Workorder&#8217;s</em> title, assignee or <em>Workflow</em>, use the the <strong>pencil</strong> icon.
The updates will sync to the end user&#8217;s Mobile Application after <code>UPDATE Workorder</code> is clicked.
To access the <em>Workorder</em> screen, click the <strong>circle with a plus</strong> icon on the bottom right side of the screen.</p>
</div>
</div>
<div class="sect2">
<h3 id="_working_with_the_mobile_application">3.2. Working with the Mobile Application</h3>
<div class="paragraph">
<p>The Mobile Application is used by an end user to interact with <em>Workorders</em> that have been assigned to them.</p>
</div>
<div class="paragraph">
<p>When an end user is logged in, they are presented with the <em>Workorders</em> screen.
To log out, click the <strong>menu</strong> icon in the top left hand side of the screen.
This will open a sidebar with options, one being the option to log out.</p>
</div>
<h4 id="_prerequisites_3" class="discrete">Prerequisites</h4>
<div class="paragraph">
<p>Ensure you have:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access to the Mobile Application</p>
</li>
</ul>
</div>
<h4 id="{context}-completing-a-workorder" class="discrete">Completing a Workorder</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log into the Mobile Application as an end user</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The end user will see the <em>Workorders</em> assigned to them</p>
</li>
</ol>
</div>
</li>
<li>
<p>Select a <em>Workorder</em> to view the first <em>Step</em> in the <em>Workorder</em>:</p>
<div class="imageblock">
<div class="content">
<img src="/docs/images/workorder-overview.png" alt="overview">
</div>
</div>
</li>
<li>
<p>To add data to the <em>Workorder</em>, click <strong>START WORKFLOW</strong> and add the necessary data</p>
</li>
<li>
<p>To move to the next <em>Step</em>, click <strong>CONTINUE</strong></p>
</li>
<li>
<p>When all <em>Steps</em> have been completed, click <strong>CONTINUE</strong> on the bottom of the screen to proceed to the <em>Summary</em> screen</p>
<div class="imageblock">
<div class="content">
<img src="/docs/images/workorder-summary.png" alt="summary">
</div>
</div>
</li>
<li>
<p>Once you are on the <em>Summary</em> screen, the <em>Workorder</em> has been completed</p>
</li>
<li>
<p>To return to the <em>Workorder</em> home screen and view the updated status of the <em>Workorder</em>, click the <strong>Menu</strong> icon in the top left hand side and return to the Workorders screen.</p>
</li>
<li>
<p>The <em>Workorder</em> is now marked with a green tick which means it was successfully completed.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Once the Mobile Application has synced with the Portal Application, a full summary of the completed <em>Workorder</em> is available for viewing on the Portal Application.</p>
</div>
</div>
<div class="sect2">
<h3 id="{context}-ref-demo-app">3.3. RainCatcher Application Reference Material</h3>
<div class="sect3">
<h4 id="{context}-credentials-for-the-mobile-and-portal-demo-application">3.3.1. Credentials for the Mobile and Portal Application</h4>
<div class="paragraph">
<p>Login using the following credentials:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 3. Credentials for the <em>Mobile</em> and <em>Portal</em> Starter Applications</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Application</th>
<th class="tableblock halign-left valign-top">Username</th>
<th class="tableblock halign-left valign-top">Password</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mobile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>trever</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>123</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Portal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>max</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>123</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For complete list of users available by default see
<a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/src/modules/passport-auth/users.json">gitub repository</a></p>
</div>
</div>
<div class="sect3">
<h4 id="{context}-structure-for-the-mobile-and-portal-starter-applications">3.3.2. Structure for the Mobile and Portal Starter Applications</h4>
<div class="paragraph">
<p>The UI Starter Applications present a consistent directory structure that can serve as a sensible base for customizations.</p>
</div>
<div class="paragraph">
<p>The following list highlights the function of the main folders:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>src/app</code></dt>
<dd>
<p>Main folder containing the logic for the application. The app is mainly concerned in providing the setup and configuration values for the RainCatcher and AngularJS modules that are used by it.</p>
</dd>
<dt class="hdlist1"><code>src/app/initialization</code></dt>
<dd>
<p>Contains configuration values and initial bootstrapping code for the AngularJS application.</p>
</dd>
<dt class="hdlist1"><code>src/app/services</code></dt>
<dd>
<p>Contains AngularJS services that are utilized by the RainCatcher modules to retrieve data. The app has the opportunity to provide an implementation that utilizes any technology for data retrieval, including static fixtures for testing.</p>
</dd>
<dt class="hdlist1"><code>src/res</code></dt>
<dd>
<p>Contains resource files (mostly bitmaps) that are used by the UI. These are also included in the various resolutions expected by the native apps.</p>
</dd>
<dt class="hdlist1"><code>src/sass</code></dt>
<dd>
<p>Contains app-wide <a href="http://sass-lang.com/">SAAS</a> files that are compiled by the build pipeline.</p>
</dd>
<dt class="hdlist1"><code>scripts/</code></dt>
<dd>
<p>Contains auxiliary scripts for the development environment.</p>
</dd>
<dt class="hdlist1"><code>www/</code></dt>
<dd>
<p>Generated directory containing the output files of the local build process.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<h1 id="building-wfm-process" class="sect0">Building a Workflow</h1>
<div class="sect1">
<h2 id="{context}-con-workflow-step">4. Building Your First Workflow Step</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Steps are internal part of the RainCatcher.</p>
</div>
<div class="paragraph">
<p>The following guide describes structure of the Step and some basic principles required to build one.
A basic knowledge of AngularJS is required to build a Workflow Step.</p>
</div>
<div class="sect2">
<h3 id="_structure_of_a_step">4.1. Structure of a Step</h3>
<div class="paragraph">
<p><em>Steps</em> are divided into two linked categories, the AngularJS Module and the Step Definition.</p>
</div>
<div class="sect3">
<h4 id="_module">4.1.1. Module</h4>
<div class="paragraph">
<p>Modules can contain one or more AngularJS directives for rendering <em>Steps</em> in the Portal and Mobile applications.
RainCatcher <em>Steps</em> use AngularJS directives to build a user interface as part of executing a Work Order.
Each <em>Step</em> is divided into two directives:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 4. A Step&#8217;s Directive</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Directive</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Edit Section directive (Form)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Edit Section is displayed when a workflow is executed and allows users to edit information - typically this would be a form.</p>
<p class="tableblock">The Edit Section consists of the a html template and a directive.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Preview Section directive (View)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Preview Section is displayed as a summary when a workflow has been completed.</p>
<p class="tableblock">The Preview Section consists of a html template and a directive.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_definition">4.1.2. Definition</h4>
<div class="paragraph">
<p>A Definition contains the <em>Step Definition</em> which outlines the properties such as the name and the description of a <em>Step</em>, for the Work Flow in the Portal application.
Each Step requires a Definition. and the <code>definition.json</code> file can contain a Definition of a single <em>Step</em> or an array of Definitions with the size corresponding to the number of <em>Steps</em> in the Step Package.
The following is an example of a Definition:</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">[
    {
        "code": "base-form",
        "name": "Base Form",
        "description": "base form used to for steps",
        "templates": {
            "form": "&lt;base-form&gt;&lt;/base-form&gt;",
            "view": "&lt;base&gt;&lt;/base&gt;"
        }
    }
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Module and the Definition are exported to be exported from the Step Package, which is a regular NodeJS package.
The following is an example of a Step Package&#8217;s main javascript file:</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">module.exports = {
  ngModule: require('./angular-module'),
  // Definition for this step that is being used in portal
  definition: require('./definition.json')
};</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_new_step_package">4.2. Creating new Step Package</h3>
<div class="paragraph">
<p>A Step Package can be created manually from a template or by using the RainCatcher Step Generator.</p>
</div>
<div class="sect3">
<h4 id="_raincatcher_step_generator">4.2.1. RainCatcher Step Generator</h4>
<div class="paragraph">
<p>The RainCatcher Step Generator provides a way to generating a Step Package automatically by answering a simple set questions via a command line interface.</p>
</div>
<div class="paragraph">
<p>The generated Step Package will contain sample UI directives that should be modified for the users' needs.</p>
</div>
<div class="paragraph">
<p>It is available as the <a href="https://www.npmjs.com/package/generator-rcstep">generator-rcstep NPM package</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_template">4.2.2. Template</h4>
<div class="paragraph">
<p>Instead of utilizing the Step Generator, developers can use a provided Step Package template:</p>
</div>
<div class="paragraph">
<p>When developing a custom Step Package, clone the <a href="https://github.com/feedhenry-raincatcher/step-template.git">step-template</a> sample repository and make modifications to the cloned repository.</p>
</div>
</div>
<div class="sect3">
<h4 id="_modifications">4.2.3. Modifications</h4>
<div class="paragraph">
<p>For more information about modifying a <em>Step</em> and importing a <em>Step</em> into the Portal and Mobile applications, see the <a href="https://github.com/feedhenry-raincatcher/step-template">Step Template&#8217;s README</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="{context}-con-packaged-step">5. RainCatcher's Packaged-Steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A <em>Packaged-Step</em> is a <em>Step</em> with basic functionality and comes as standard with the RainCatcher Application.
A <em>Packaged-Step</em> is designed to be versatile so that it can be used with a wide range of <em>Workflows</em>.</p>
</div>
<div class="sect2">
<h3 id="_the_signature_step">5.1. The Signature Step</h3>
<div class="paragraph">
<p>The <a href="https://github.com/feedhenry-raincatcher/raincatcher-angularjs/blob/master/steps/step-signature/">Signature Step</a> is a <em>Packaged-Step</em> and it is used to capture a signature.
A user inputs their signature through the UI and it is stored as an image.
A user uses their finger or stylus, for example, to input their signature on a mobile device (the mobile device must have a touch screen).
The captured signature is displayed as part of a completed <em>Workorder</em>.</p>
</div>
<div class="paragraph">
<p>Like all <em>Steps</em>, a Signature Step is made up of a <code>module</code> and a <code>definition</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_packaged_step_roadmap">5.2. Packaged-Step Roadmap</h3>
<div class="paragraph">
<p>The following list displays the <em>Packaged-Steps</em> that are on the RainCatcher roadmap:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Plugable authentication</p>
</li>
<li>
<p>Image capture</p>
</li>
<li>
<p>Geolocation</p>
</li>
<li>
<p>Internal Messaging and 3rd party Messaging</p>
</li>
<li>
<p>Mobile Forms</p>
</li>
<li>
<p>Real-time Data Access</p>
</li>
<li>
<p>Integration of sensor data</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<h1 id="top-level-apps-overview" class="sect0">Top Level Applications Overview</h1>
<div class="sect1">
<h2 id="{context}-con-wfm">6. Understanding the <strong>RainCatcher</strong> Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <strong>RainCatcher</strong> Application consists of three components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <strong>Mobile Application</strong> for end users</p>
</li>
<li>
<p>A <strong>Portal Application</strong> for administrator users and accessed through a web browser</p>
</li>
<li>
<p>A <strong>Cloud Application</strong> for backend server functionality (there is no user interface)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An administrator can define a business process or procedure via a custom <em>Workflow</em>.
A <em>Workflow</em> contains one to many <em>Steps</em>.
A <em>Workorder</em> is an individual instance of a <em>Workflow</em> and it (the <em>Workorder</em>) is assigned to an end user (or to many end users) as a job that they are to complete.
An end user can view their <em>Workorder</em> via a <strong>Mobile Application</strong>.
An administrator can manage the <em>Workorder</em> via the <strong>Portal Application</strong>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <strong>RainCatcher</strong> Application is supplied with demo users and data, and both are used to assist a User when demonstrating <strong>RainCatcher</strong> functionality.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <strong>Portal Application</strong> is used by an administrator to essentially manage the <em>Workorder</em>.
An administrator can view, edit and assign a <em>Workorder</em> and also create a new <em>Workflow</em>.
When an administrator logs into the <strong>Portal Application</strong>, there are two separate areas that they can access on the Portal Application: the <em>Workflow</em> and the <em>Workorder</em>.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 5. Available Areas on the Portal Application</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Area</th>
<th class="tableblock halign-left valign-top">Functionality</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Workflow</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create, read, update, delete and list operations can be executed against a <em>Workflow</em>.</p>
<p class="tableblock">Manage <em>Workflows</em> and add additional <em>Steps</em> to an existing <em>Workflow</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Workorder</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create, read, update, delete and list operations can be executed against a <em>Workorder</em>.</p>
<p class="tableblock">Manage <em>Workorders</em> by assigning them to individual end users.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Once a <em>Workorder</em> has been created, any <em>Workflows</em> based in this <em>Workorder</em> become unchangeable, that is, the sequence of <em>Steps</em> that make up the <em>Workorder</em> cannot be changed.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="{context}-con-wfm-supported-modules">7. RainCatcher Supported Modules</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes <strong>RainCatcher&#8217;s</strong> <em>core</em> list of modules.
The latest list of modules is found at <a href="https://www.npmjs.com/org/raincatcher/">RainCatcher Modules</a>.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 6. RainCatcher Supported Modules</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Module</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../../api/1.0.0/express-auth/docs/index.html">@raincatcher/express-auth</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The RainCatcher Security Interface is used to apply authentication and authorization, used in conjunction with a security provider chosen by you.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../../api/1.0.0/auth-passport/docs/index.html">@raincatcher/auth-passport</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The RainCatcher implementation of Passport.js which is the default security module for Mobile and Portal applications.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../../api/1.0.0/datasync-cloud/docs/index.html">@raincatcher/datasync-cloud</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The RainCatcher Cloud implementation of fh-sync used in conjunction with @raincatcher/datasync-client. This is used to sync data between the Cloud and Mobile applications.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../../api/1.0.0/datasync-client/docs/index.html">@raincatcher/datasync-client</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The RainCatcher Client implementation of fh-sync used in conjunction with @raincathcer/datasync-cloud. This is used to sync data between the Cloud and Mobile applications.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../../api/1.0.0/wfm/docs/index.html">@raincatcher/wfm</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The RainCatcher Work Flow Management module which allows developers to map a business process into an organized set of tasks to suit a businesses needs.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../../api/1.0.0/wfm-rest-api/docs/index.html">@raincatcher/wfm-rest-api</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The RainCatcher Work Flow Management API module exposes express API endpoints for Work Flow Management Objects.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../../api/1.0.0/wfm-user/docs/index.html">@raincatcher/wfm-user</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The RainCatcher Aggregates all user operations for RainCatcher modules.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="../../../api/1.0.0/wfm-demo-data/docs/index.html">@raincatcher/wfm-demo-data</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is a sample module containing static data definitions and when running, it allows the user to see the RainCatcher demo project example.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="{context}-ref-mobile">8. Mobile Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Mobile AngularJS based application that provides interface for field operators.
Developers who base their solution on RainCatcher can extend it by providing additional UI elements, themes and functionalities.</p>
</div>
<div class="sect2">
<h3 id="_running_on_a_browser">8.1. Running on a browser</h3>
<div class="paragraph">
<p>After installing all dependencies, run these commands to test this application on a local browser:</p>
</div>
<div class="paragraph">
<p><code>npm start</code></p>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="paragraph">
<p><code>grunt serve:local --url=http://localhost:8001</code></p>
</div>
<div class="paragraph">
<p>The <code>url</code> parameter should be the root of the API server application running the api endpoints. See <a href="#{context}-ref-server">server side documentation</a> for information how to run server</p>
</div>
</div>
<div class="sect2">
<h3 id="_repository_structure">8.2. Repository Structure</h3>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 7. RainCatcher Mobile Application Repository Structure</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Folder</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src/app</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Main folder containing the logic for the application. The app is mainly concerned in providing the setup and configuration values for the RainCatcher and AngularJS modules that are used by it.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>src/app/services</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains AngularJS services that are utilized by the RainCatcher modules to retrieve data. The app has the opportunity to provide an implementation that utilizes any technology for data retrieval, including static fixtures for testing.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>src/app/app.js</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Has a small AngularJS controller for displaying a template before data is loaded from the backend server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>src/sass</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains app-wide [Sass](<a href="http://sass-lang.com/" class="bare">http://sass-lang.com/</a>) files that are compiled by the build pipeline.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>src/app/initialization</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains configuration values and initial bootstrapping code for the AngularJS application.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>src/res</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains resource files (mostly bitmaps) that are used by the UI. These are also included in the various resolutions expected by the native apps.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>www/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generated directory containing the output files of the local build process. This directories contents are what is served by the local development web server.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_running_on_a_device_emulator">8.3. Running on a Device Emulator</h3>
<div class="paragraph">
<p>To run this application on a device emulator, setup the appropriate native SDKs and run the app through the following commands:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Change config.xml content field to point to running application server
Provide valid url value.</p>
<div class="paragraph">
<p><code>&lt;content src="index.html?url=http://localhost:8001" /&gt;</code></p>
</div>
</li>
<li>
<p>Build Android</p>
<div class="paragraph">
<p><code>cordova prepare</code>
<code>cordova build android --verbose</code></p>
</div>
</li>
<li>
<p>Push apk to your device</p>
<div class="paragraph">
<p><code>cordova run android</code></p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>See the [Apache Cordova project documentation](<a href="https://cordova.apache.org/docs/" class="bare">https://cordova.apache.org/docs/</a>) for details on how to configure your environment for running applications on a device emulator.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="{context}-ref-portal">9. Portal Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Portal AngularJS based application that provides interface for process management. Developers who base their solution on RainCatcher can extend it by providing additional UI elements, themes and functionalities.</p>
</div>
<div class="sect2">
<h3 id="_running_on_a_browser_2">9.1. Running on a browser</h3>
<div class="paragraph">
<p>After installing all dependencies, run these commands to test this application on a local browser:</p>
</div>
<div class="paragraph">
<p><code>npm start</code></p>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="paragraph">
<p><code>grunt serve:local --url=http://localhost:8001</code></p>
</div>
<div class="paragraph">
<p>The <code>url</code> parameter should be the root of the API server application running the api endpoints. See <a href="#{context}-ref-server">server side documentation</a> for information how to run server</p>
</div>
</div>
<div class="sect2">
<h3 id="_repository_structure_2">9.2. Repository Structure</h3>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 8. RainCatcher Portal Application Repository Structure</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Folder</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">src/app</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Main folder containing the logic for the application. The app is mainly concerned in providing the setup and configuration values for the RainCatcher and AngularJS modules that are used by it.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>src/app/services</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains AngularJS services that are utilized by the RainCatcher modules to retrieve data. The app can utilize any technology for data retrieval, including static fixtures for testing.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>src/app/home</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Has a small AngularJS controller for displaying a temporary template before data is loaded from the backend server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>src/app/sass</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains app-wide [Sass](<a href="http://sass-lang.com/" class="bare">http://sass-lang.com/</a>) files that are compiled by the build pipeline.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>www/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generated directory containing the output files of the local build process. This directories contents are what is served by the local development web server.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="{context}-ref-server">10. Server Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Server Application is a Node.js server that provides APIs for mobile and portal clients.
A Developer can use RainCatcher as a base solution and can extend it by providing additional API and using custom plugins.
The Server Application has a modular structure, that is, all functionality and integrations are imported as modules and can be removed or replaced at a later point.</p>
</div>
<div class="sect2">
<h3 id="_raincatcher_server">10.1. RainCatcher Server</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Active Release Version</p>
<div class="paragraph">
<p>The Active Release version contains all resources including javascript and other build artifacts.
<a href="https://github.com/feedhenry-RainCatcher/RainCatcher-server" class="bare">https://github.com/feedhenry-RainCatcher/RainCatcher-server</a> master version always contains the most recent release.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can refer to a specific release version by using tag.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Active Development Version</p>
<div class="paragraph">
<p>The Active Development version is used by RainCatcher contributors and contains only TypeScript source code.
<a href="https://github.com/feedhenry-RainCatcher/RainCatcher-core/blob/master/demo/server" class="bare">https://github.com/feedhenry-RainCatcher/RainCatcher-core/blob/master/demo/server</a></p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_server_side_application_development_guide">10.2. Server-side Application Development Guide</h3>
<div class="paragraph">
<p>To launch the Cloud Application, execute <code>npm run start:ts</code>, this runs the Server Application from its TypeScript sources.</p>
</div>
<div class="paragraph">
<p>To start debugging, execute <code>npm run startDebug</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Both commands use a tool called <code>ts-node</code> and this runs a process without compiling Typescript source code.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To run the code using Node.JS, ensure you compile the code first:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>npm run build</code></p>
</li>
<li>
<p><code>npm run start</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When compiling source code, the <code>ts-node</code> command uses compiled Javascript files. To clean compiled Javascript files, execute <code>npm run clean</code></p>
</div>
<div class="sect3">
<h4 id="_prerequisites_for_a_local_environment">10.2.1. Prerequisites for a Local Environment</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you run the RainCatcher solution as part of the RHMAP platform, this prerequisites does not apply.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>mongodb installed and running on port 27017 | URL controlled by <code>process.env.MONGO_CONNECTION_URL</code> and <code>config-{env}.json</code> file</p>
</li>
<li>
<p>redis installed and running on port 6379 | URL controlled by <code>process.env.REDIS_CONNECTION_URL</code> and <code>config-{env}.json</code> file</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_server_side_configuration">10.2.2. Server-side Configuration</h4>
<div class="paragraph">
<p>The Server Application offers different configuration profiles depending on the target application deployment.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>config-dev.js (for developer/local setup - used by default)</p>
</li>
<li>
<p>config-prod.js (for production uses)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also add another profile name using the <code>config-profile-name.js</code> pattern.</p>
</div>
<div class="paragraph">
<p>Profiles can be changed using <code>process.env.CONFIG_PROFILE</code> variable, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>// use production profile.
process.env.CONFIG_PROFILE === 'prod'
// it will load config-prod.js file in top level application</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, the server will load a development profile.
All configuration parameters are documented directly in Javascript file.
Developers building their solution on top of the RainCatcher are free to extend the configuration.</p>
</div>
</div>
<div class="sect3">
<h4 id="_structure">10.2.3. Structure</h4>
<div class="ulist">
<ul>
<li>
<p><code>modules</code> - this folder contains a sample implementation for RainCatcher integrations, for example, sync or security. Developers are free to modify and tweak these.</p>
</li>
<li>
<p><code>user-routes</code> - contains custom routes (non RainCatcher specific)</p>
</li>
<li>
<p><code>app.js</code> - the main application code that mounts express routes</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_configuring_custom_query_parameters_for_mobile_clients">10.2.4. Configuring Custom Query Parameters for Mobile Clients</h4>
<div class="paragraph">
<p>A Mobile client that is based on the sync framework might not require all WorkOrders in order to operate.</p>
</div>
<div class="paragraph">
<p>To save on local memory usage, data traffic and also to improve performance, additional filters can be added to limit those.</p>
</div>
<div class="paragraph">
<p>In the sample implementation, WorkOrders whose status are complete are no longer sent to mobile clients after two days of their completion.
This is configured via the <code>sync.daysToExcludeCompleteWorkorders</code> configuration key.
It illustrates a way to include a relatively complex MongoDB query filter into the chain that is used by the list handler for the sync framework.</p>
</div>
</div>
</div>
</div>
</div>
<h1 id="integrations" class="sect0">RainCatcher Integrations</h1>
<div class="openblock partintro">
<div class="content">
An integration is the use of existing Open Source projects to solve specific needs or provide extra functionality for RainCatcher.
RainCatcher has a number of intergrations that leverage other Open Source projects for their expertise in paticular fields and particular important features.
Thes integrations enable the inclusion of domain expertise in, for instance, the areas of authentication, authoriztion and security, and data synchronization in RainCatcher.
</div>
</div>
<div class="sect1">
<h2 id="_sync">11. Sync</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="{context}-con-datasync">11.1. Introducing the RainCatcher Datasync Module</h3>
<div class="paragraph">
<p>The <strong>RainCatcher Datasync</strong> Module is an implementation of the <strong>FeedHenry</strong> Sync Framework.
<strong>Datasync</strong> is made up of two modules, the <a href="#{context}-datasync-cloud-module">Cloud module</a> and the <a href="#{context}-datasync-client-module">Client module</a>.
The primary function of <strong>Datasync</strong> is to synchronize data, for example, a <em>workorder</em>, between the Client Application (mobile) and the backend server.</p>
</div>
<div class="paragraph">
<p><strong>Datasync</strong> key features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Allows mobile applications to use and update data while being offline</p>
</li>
<li>
<p>Provides a mechanism to manage bi-directional data synchronization from multiple clients into back-end data stores via the server.</p>
</li>
<li>
<p>Allows data updates (that is, deltas) to be distributed from the server to connected clients</p>
</li>
<li>
<p>Provides facilities for managing data collisions from multiple updates in the cloud</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For advanced usage of the <strong>Datasync</strong> module, see the <a href="https://access.redhat.com/documentation/en-us/red_hat_mobile_application_platform/4.4/html/server-side_developer_guide/server-side-developer-guide-using-rhmap-data-sync-framework">Sync Documentation</a></p>
</div>
<div class="sect3">
<h4 id="{context}-datasync-cloud-module">11.1.1. Datasync Cloud</h4>
<div class="paragraph">
<p>The <strong>Datasync Cloud</strong> is a wrapper for the <a href="https://github.com/feedhenry/fh-sync">FeedHenry datasync server</a>. The <strong>Datasync Cloud</strong> creates a server side service that allows clients to synchronize offline data to a preferred back-end data store. By default, the Cloud module utilizes a MongoDB database back-end for storing the client data.</p>
</div>
<div class="paragraph">
<p>For instructions on how to implement the <strong>Datasync Cloud</strong>, see <a href="https://github.com/feedhenry-raincatcher/raincatcher-core/blob/master/cloud/datasync/README.md">README</a></p>
</div>
<div class="paragraph">
<p>To view an example, see the <strong>Datasync Cloud</strong> <a href="https://github.com/feedhenry-raincatcher/raincatcher-core/blob/master/cloud/datasync/example/index.ts">example</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="{context}-datasync-client-module">11.1.2. Datasync Client</h4>
<div class="paragraph">
<p>The <strong>Datasync Client</strong> is based on the <a href="https://github.com/feedhenry/fh-sync-js">sync.js client</a>. In order to work, the <strong>Datasync Client</strong> requires the <strong>Datasync Cloud</strong> to be running on an <em>Express.js</em> based web server.
The <em>Data Synchronization Library</em> can be used for offline storage of the client&#8217;s data.</p>
</div>
<div class="paragraph">
<p>For instructions on how to implement the <strong>Datasync Client</strong>, see <a href="https://github.com/feedhenry-raincatcher/raincatcher-core/blob/master/client/datasync-client/README.md">README</a></p>
</div>
<div class="paragraph">
<p>To view an example, see the <strong>Datasync Client App</strong> <a href="https://github.com/feedhenry-raincatcher/raincatcher-core/blob/master/client/datasync-client/example/index.ts">example</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_security_introduction">12. Security introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="{context}-con-introducing-securityfeatures">12.1. Introducing RainCatcher Security Features</h3>
<div class="paragraph">
<p><strong>RainCatcher</strong> Security is built around a <strong>Security Interface</strong> which abstracts itself from all <strong>RainCatcher</strong> security libraries.
<strong>RainCatcher</strong> allows you to integrate a custom security solution.
<strong>RainCatcher</strong> also provides two out-of-the-box security implementations called <a href="http://www.keycloak.org/">Keycloak</a> and <a href="http://passportjs.org/">Passport.js</a>.</p>
</div>
<div class="paragraph">
<p><strong>Keycloak</strong> and <strong>Passport.js</strong> both provide server side authentication and authorization.
<strong>Keycloak</strong> and <strong>Passport.js</strong> implementations are interchangeable since they implement the <strong>RainCatcher</strong> <strong>Security Interface</strong>, and thus can operate with all modules and also any of the reference applications.</p>
</div>
<div class="sect3">
<h4 id="_authorization_using_the_security_interface">12.1.1. Authorization using the Security Interface</h4>
<div class="paragraph">
<p>If you build a custom security implementation, the endpoints are secured in the same way as the <strong>Keycloak</strong> and <strong>Passport.js</strong> implementations.</p>
</div>
<div class="paragraph">
<p>If you choose to build a custom security implementation, you will need to:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Import the <a href="../../../api/1.0.0/express-auth/docs/interfaces/_src_endpointsecurity_.endpointsecurity.html">EndpointSecurity</a> interface from the <strong>Passport.js</strong> implementation</p>
</li>
<li>
<p>Implement the interface in the custom security implementation</p>
</li>
<li>
<p>Use the <em>protect</em> method to guard routes (the security permissions being role based)</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
All <a href="https://expressjs.com/">express</a> routes outside of RainCatcher modules must implement the <a href="../../../api/1.0.0/express-auth/docs/interfaces/_src_endpointsecurity_.endpointsecurity.html">EndpointSecurity</a> Security Interface.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_introducing_passport_js">12.1.2. Introducing Passport.js</h4>
<div class="paragraph">
<p><strong>Passport.js</strong> is a lightweight authentication middleware solution for Node.js and can be bundled into an existing Node.js server.
<strong>Passport.js</strong> offers a comprehensive set of <a href="http://passportjs.org/docs/configure">strategies</a> that support authentication using a username and password, existing social media and other 3rd party accounts, and more.</p>
</div>
<div class="paragraph">
<p>For more information, see <a href="http://passportjs.org/">passportjs.org</a>.</p>
</div>
<div class="paragraph">
<p>The <strong><a href="https://github.com/feedhenry-raincatcher/raincatcher-core/tree/master/cloud/passportauth">PassportAuth Module</a></strong> is <strong>RainCatcher&#8217;s</strong> implementation of <strong>Passport.js</strong> and is the default authentication and authorization module for <strong>RainCatcher</strong>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_introducing_keycloak">12.1.3. Introducing Keycloak</h4>
<div class="paragraph">
<p><strong>Keycloak</strong> is a complete identity management solution. It extends standard authorization and authentication functionality, and comes with all the overheads involved in running a separate server.
Red Hat recommends using <strong>Keycloak</strong> in production to avail of the many features available for enterprise security including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.keycloak.org/docs/latest/server_admin/topics/sso-protocols.html">Single-Sign On</a></p>
</li>
<li>
<p><a href="http://www.keycloak.org/docs/latest/server_admin/topics/user-federation.html">User Federation</a></p>
</li>
<li>
<p><a href="http://www.keycloak.org/docs/latest/server_admin/topics/authentication/x509.html">Client Cert Authentication</a></p>
</li>
<li>
<p><a href="http://www.keycloak.org/docs/latest/server_admin/topics/authentication/otp-policies.html">2FA with OTP</a></p>
</li>
<li>
<p><a href="http://www.keycloak.org/docs/latest/server_admin/topics/sessions/administering.html">User Session Management</a></p>
</li>
<li>
<p><a href="http://www.keycloak.org/docs/latest/server_admin/topics/events.html">Auditing</a></p>
</li>
<li>
<p><a href="http://www.keycloak.org/docs/latest/server_admin/topics/threat/brute-force.html">Brute Force Detection</a></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<strong>Keycloak</strong> is <em>not</em> available by default when running the default RainCatcher solution.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_choosing_passport_js_or_keycloak">12.1.4. Choosing Passport.js or Keycloak</h4>
<div class="paragraph">
<p><strong>Passport.js</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you want a standalone Node.js based authentication solution that is ready out-of-the-box, choose <strong>Passport.js</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Keycloak</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you want a full identity management solution that can be tied into existing SAML/LDAP/SSO solutions, choose <strong>Keycloak</strong>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_keycloak">13. Using Keycloak</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="{context}-con-keycloak">13.1. Introducing Keycloak within RainCatcher</h3>
<div class="paragraph">
<p><strong>Keycloak</strong> is a complete identity management solution.</p>
</div>
<div class="paragraph">
<p>The <strong>RainCatcher</strong> demo application allows for authentication and access management using <a href="http://www.keycloak.org/index.html"><strong>Keycloak</strong></a>
however, <strong>Keycloak</strong> is not the default authorization and authentication module for <strong>RainCatcher</strong>.</p>
</div>
<div class="paragraph">
<p>The configuration for <strong>Keycloak&#8217;s</strong> integration is found within the demo application.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
To configure your own instance of <strong>Keycloak</strong>, see the <a href="http://www.keycloak.org/docs/latest/getting_started/topics/first-boot.html">Keycloak Getting Started Guide</a>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="{context}-ref-keycloak-material">13.1.1. Keycloak Reference Material</h4>
<div class="sect4">
<h5 id="{context}-credentials-for-the-demo-application">Credentials for the Keycloak Admin Console</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Login as the <em>admin</em> user using the following credentials:</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 9. Keycloak Admin Console Credentials</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Username</th>
<th class="tableblock halign-left valign-top">Password</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">admin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">admin</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="{context}-con-keycloak-securitystrategy">13.2. Introducing the Security Strategy for Keycloak</h3>
<div class="paragraph">
<p>The <strong>RainCatcher Keycloak</strong> Security Strategy describe the security aspects for <strong>Keycloak</strong> and cover areas such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Understanding Keycloak Terminologies</p>
</li>
<li>
<p>Understanding Keycloak Client Adapters</p>
</li>
<li>
<p>Understanding Keycloak Session Management</p>
</li>
<li>
<p>Defining Keycloak Access Control</p>
</li>
<li>
<p>Defining Keycloak Password Storage</p>
</li>
<li>
<p>Keycloak Authentication</p>
</li>
<li>
<p>Keycloak Authorization</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="{context}-ref-keycloak-securitystrategy">13.2.1. Defining the Security Strategy for RainCatcher Keycloak</h4>
<h5 id="{context}-understanding-keycloak-terminologies" class="discrete">Understanding Keycloak Terminologies</h5>
<div class="paragraph">
<p>There are some key concepts and terminologies to be aware of before using Keycloak. For more
information on these key concepts and terminologies, see the <a href="http://www.keycloak.org/docs/latest/server_admin/topics/overview/concepts.html">Keycloak Core Concepts</a> documentation.</p>
</div>
<h5 id="{context}-understanding-keycloak-client-adapters" class="discrete">Understanding Keycloak Client Adapters</h5>
<div class="paragraph">
<p>RainCatcher uses the Node.js Client Adapter for the RainCatcher server and the Javascript Client Adapter for the RainCatcher mobile and portal.</p>
</div>
<div class="paragraph">
<p>For more information on the Node.js Client Adapter, see the <a href="http://www.keycloak.org/docs/latest/securing_apps/topics/oidc/nodejs-adapter.html#_nodejs_adapter">Node.js Adapter</a> documentation</p>
</div>
<div class="paragraph">
<p>For more information on the Javascript Client Adapter, see the <a href="http://www.keycloak.org/docs/latest/securing_apps/topics/oidc/javascript-adapter.html">Javascript Adapter</a> documentation.</p>
</div>
<h5 id="{context}-understanding-keycloak-session-management" class="discrete">Understanding Keycloak Session Management</h5>
<div class="paragraph">
<p>The <em>express-session</em> module provides session management functionality and
the management of sessions is performed on the <a href="http://www.keycloak.org/docs/latest/server_admin/topics/sessions/administering.html">Keycloak server</a>
For more information on <em>express-session</em>, see <a href="https://github.com/expressjs/session">express-session</a>.</p>
</div>
<h5 id="{context}-defining-keycloak-access-control" class="discrete">Defining Keycloak Access Control</h5>
<div class="paragraph">
<p>Keycloak provides role-based access control and is configured on the Keycloak server.
For more information about role-based access control, see <a href="http://www.keycloak.org/docs/latest/server_admin/topics/roles.html">Keycloak Roles</a>.</p>
</div>
<div class="paragraph">
<p>See the <a href="#{context}-protect-express-routes">Protect Express Routes</a> section on how routes are protected in the application.
For more information on protecting express routes, see the Keycloak <a href="http://www.keycloak.org/docs/latest/securing_apps/topics/oidc/nodejs-adapter.html">Node.js Adapter</a>.</p>
</div>
<h5 id="{context}-defining-keycloak-password-storage" class="discrete">Defining Keycloak Password Storage</h5>
<div class="paragraph">
<p>Keycloak uses the <a href="https://en.wikipedia.org/wiki/PBKDF2">PBKDF2 algorithm</a> for password hashing by default.
Keycloak also provides enforced <a href="http://www.keycloak.org/docs/latest/server_admin/topics/authentication/password-policies.html">password policies</a> from the server.</p>
</div>
<div class="paragraph">
<p>For more information on server administration topics, see <a href="http://www.keycloak.org/docs/latest/server_admin/topics/identity-broker.html">identity-broker</a> and <a href="http://www.keycloak.org/docs/latest/server_admin/topics/user-federation.html">user federation</a>.</p>
</div>
<h5 id="{context}-keycloak-authentication" class="discrete">Keycloak Authentication</h5>
<div class="paragraph">
<p>Keycloak has a wide variety of authentication mechanisms available. For more information, see the <a href="http://www.keycloak.org/docs/latest/server_admin/topics/authentication.html">Keycloak Authentication Documentation</a>.</p>
</div>
<h5 id="{context}-keycloak-authorization" class="discrete">Keycloak Authorization</h5>
<div class="paragraph">
<p>Authorization is fully documented in the <a href="http://www.keycloak.org/docs/latest/authorization_services/index.html">Keycloak Authorization Documentation</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="{context}-pro-keycloak-enablement">13.3. Enabling Keycloak</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Enabling Keycloak requires the disabling of <strong>PassportAuth</strong>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_prerequisites_4">13.3.1. Prerequisites</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure you have completed <a href="#getting-started">Getting Started</a></p>
</li>
<li>
<p>A <a href="https://www.docker.com/">Docker</a> installation (tested with version: &lt;latest version&gt;)</p>
</li>
<li>
<p>Knowledge of Keycloak terminologies. See the <a href="#{context}-understanding-keycloak-terminologies">Understanding Keycloak Terminologies</a> section for more information.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you choose to run your own Keycloak instance, ensure that a Keycloak realm is setup for the RainCatcher applications
to use. For more information, see <a href="#{context}-setup-keycloak-realm">Setting up a Keycloak Realm</a> section.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="{context}-run-keycloak-docker-image">13.3.2. Running the Keycloak Docker Image</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open a terminal and run the Keycloak Docker image</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">docker run -p 8080:8080 feedhenry/raincatcher-keycloak</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about the Keycloak Docker Image, see the Keycloak <a href="https://github.com/feedhenry-raincatcher/raincatcher-keycloak/blob/master/README.md">README.md</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
The Keycloak realm setup included in this docker image is configured for local development only. Ensure that you provide proper client
configurations for production environments. See <a href="#{context}-keycloak-configuration-production">Keycloak Configuration for Production Environments</a> for more information.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="{context}-setup-keycloak-realm">13.3.3. Setting up a Keycloak Realm</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This step is only valid if you choose to run your own Keycloak instance or if you prefer to create your own Keycloak realm.
The Keycloak Docker image comes with a pre-configured RainCatcher realm therefore it does not need to be manually configured.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Keycloak realm can be configured in two different ways:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use the existing <a href="https://github.com/feedhenry-raincatcher/raincatcher-keycloak/blob/master/data_files/raincatcher-realm.json">Keycloak realm configuration</a>
and import it to your own Keycloak instance.</p>
</li>
<li>
<p>Create your own Keycloak realm.</p>
</li>
</ol>
</div>
<h5 id="{context}-import-keycloak-realm-configuration" class="discrete">Importing the Keycloak Realm Configuration</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download the <a href="https://github.com/feedhenry-raincatcher/raincatcher-keycloak/blob/master/data_files/raincatcher-realm.json">RainCatcher realm configuration</a></p>
</li>
<li>
<p>Login to the Keycloak admin console. See <a href="#{context}-accessing-the-keycloak-admin-console">Accessing the Keycloak Admin Console</a> for more information.</p>
</li>
<li>
<p>Click 'Add Realm'</p>
</li>
<li>
<p>Import the <a href="https://github.com/feedhenry-raincatcher/raincatcher-keycloak/blob/master/data_files/raincatcher-realm.json">RainCatcher realm settings</a> you downloaded</p>
</li>
<li>
<p>Click 'Create'</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This will create the demo RainCatcher realm which includes the setup for three different clients: raincatcher-portal, raincatcher-mobile and raincatcher-cloud.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
The provided <a href="https://github.com/feedhenry-raincatcher/raincatcher-keycloak/blob/master/data_files/raincatcher-realm.json">RainCatcher realm configuration</a> is only configured for
local development. Ensure that you provide proper client configurations for production environments.
See <a href="#{context}-keycloak-configuration-production">Keycloak Configuration for Production Environments</a> for more information.
</td>
</tr>
</table>
</div>
<h5 id="{context}-create-own-keycloak-realm" class="discrete">Creating your own Keycloak Realm</h5>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Creating your own Keycloak Realm requireds an advanced understanding of Keycloak and its Node.js and Javascript Adapters.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See the Keycloak <a href="http://www.keycloak.org/docs/latest/server_admin/topics/realms/create.html">realm</a> documentation for more information on how to create a new realm within a Keycloak instance.</p>
</div>
<div class="paragraph">
<p>The realm must adhere to the following configurations in order to use it with the RainCatcher applications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Realm settings</p>
<div class="listingblock">
<div class="content">
<pre>Required SSL: external</pre>
</div>
</div>
</li>
<li>
<p>Client settings</p>
<div class="ulist">
<ul>
<li>
<p>The realm must have three different clients for each of the RainCatcher applications: Server, Portal and Mobile.</p>
</li>
<li>
<p>Server Client:</p>
<div class="listingblock">
<div class="content">
<pre>Enabled: true
Client Protocol: openid-connect
Access Type: bearer-only</pre>
</div>
</div>
</li>
<li>
<p>Portal Client:</p>
<div class="listingblock">
<div class="content">
<pre>Enabled: true
Client Protocol: openid-connect
Access Type: public
Standard Flow Enabled: true
Valid Redirect URIs: [Ensure that this is configured with the correct URL patterns]
Web Origins: *</pre>
</div>
</div>
</li>
<li>
<p>Mobile Client:</p>
<div class="listingblock">
<div class="content">
<pre>Enabled: true
Client Protocol: openid-connect
Access Type: public
Standard Flow Enabled: true
Valid Redirect URIs: [Ensure that this is configured with the correct URL patterns]
Web Origins: *</pre>
</div>
</div>
</li>
<li>
<p>For more information on the configurations above, see the Keycloak <a href="http://www.keycloak.org/docs/latest/server_admin/topics/clients/client-oidc.html">OpenID Connect configurations</a> documentation.</p>
</li>
</ul>
</div>
</li>
<li>
<p>User settings</p>
<div class="ulist">
<ul>
<li>
<p>Ensure that each user has the following attribute fields:</p>
<div class="ulist">
<ul>
<li>
<p>id: Used as an identifier for the user.</p>
</li>
<li>
<p>avatar: A link to the user&#8217;s avatar image to be displayed on the user panel (Used in the mobile application).</p>
</li>
<li>
<p>name: The name of the user to be displayed on the user panel (Used in the mobile application).</p>
</li>
</ul>
</div>
</li>
<li>
<p>For more information on user attributes, see the Keycloak <a href="http://www.keycloak.org/docs/latest/server_admin/topics/users/attributes.html">user attributes</a> documentation.</p>
</li>
<li>
<p>Ensure that each user has the appropriate roles. For more information on roles, see <a href="#{context}-defining-keycloak-access-control">Defining Keycloak Access Control</a>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="{context}-adding-keycloak-configuration">13.3.4. Adding Keycloak Configuration</h4>
<h5 id="{context}-adding-keycloak-configuration-server" class="discrete">Adding Keycloak Configuration in the Server Application</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Choose which <em>configuration file</em> to edit:</p>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 10. Keycloak Configuration File</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Area</th>
<th class="tableblock halign-left valign-top">File Name</th>
<th class="tableblock halign-left valign-top">File Location</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Development</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/config-dev.js">config-dev.js</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/config-dev.js</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Production</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/config-prod.js">config-prod.js</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/config-prod.js</p></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Open the configuration file and fill in the missing field values for realm, auth-server-url and resource:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">"keycloakConfig": {
  "realm": "raincatcher",
  "bearer-only": true,
  "auth-server-url": "http://localhost:8080/auth",
  "ssl-required": "external",
  "resource": "raincatcher-cloud",
  "use-resource-role-mappings": true
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Ensure that the realm, auth-server-url and resource values correspond to your client configuration within your
realm. Ensure that the values for the fields <strong>bearer-only</strong>, <strong>ssl-required</strong> and <strong>use-resource-role-mappings</strong> are not changed.
For more information, see the Keycloak <a href="http://www.keycloak.org/docs/latest/securing_apps/topics/oidc/nodejs-adapter.html">Node.js Adapter documentation</a>.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Filling in the realm, auth-server-url and resource fields in the keycloakConfig also enables Keycloak in the server application
</td>
</tr>
</table>
</div>
<h5 id="_keycloak_configuration_in_the_mobile_application" class="discrete">Keycloak Configuration in the Mobile Application</h5>
<div class="paragraph">
<p>The <em>Keycloak Configuration</em> for the mobile application is already filled in. This may be customized by changing the realm, url and clientId fields
within the application&#8217;s <a href="https://github.com/feedhenry-raincatcher/raincatcher-mobile/blob/master/src/config.json">config.json</a> to values which corresponds to your own client configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Ensure that the values for the rest of the fields apart from the realm, url and clientId are not changed.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more information on Javascript Adapter configurations,
see the Keycloak <a href="http://www.keycloak.org/docs/latest/securing_apps/topics/oidc/javascript-adapter.html">Javascript Adapter</a> documentation.</p>
</div>
<h5 id="_keycloak_configuration_in_the_portal_application" class="discrete">Keycloak Configuration in the Portal Application</h5>
<div class="paragraph">
<p>The <em>Keycloak Configuration</em> for the portal application is already filled in. This may be customized by changing the <strong>realm</strong>, <strong>url</strong> and <strong>clientId</strong> fields
within the application&#8217;s <a href="https://github.com/feedhenry-raincatcher/raincatcher-portal/blob/master/src/config.json">config.json</a> to values which corresponds to your own client configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Ensure that the values for the rest of the fields apart from the realm, url and clientId are not changed.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more information on Javascript Adapter configurations,
see the Keycloak <a href="http://www.keycloak.org/docs/latest/securing_apps/topics/oidc/javascript-adapter.html">Javascript Adapter</a> documentation.</p>
</div>
</div>
<div class="sect3">
<h4 id="{context}-enabling-keycloak-on-the-server">13.3.5. Enabling Keycloak on the RainCatcher Applications</h4>
<h5 id="_enabling_keycloak_on_the_server_application" class="discrete">Enabling Keycloak on the Server Application</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Fill in the Keycloak configuration in the server application.</p>
</li>
<li>
<p>At this point, the routes are protected by Keycloak.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>See <a href="#{context}-adding-keycloak-configuration-server">Adding Keycloak Configuration in the Server</a> for more information.</p>
</div>
<h5 id="_enabling_keycloak_on_the_mobile_application" class="discrete">Enabling Keycloak on the Mobile Application</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the file <a href="https://github.com/feedhenry-raincatcher/raincatcher-mobile/blob/master/src/app/app.js">app.js</a> in location <em>/src/app/</em></p>
</li>
<li>
<p>Disable Passport.js and require Keycloak</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">  require('./keycloak')</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Ensure that Passport.js is disabled by not requiring ./passport and @raincatcher/angularjs-auth module.
</td>
</tr>
</table>
</div>
<h5 id="_enabling_keycloak_on_the_portal_application" class="discrete">Enabling Keycloak on the Portal Application</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the file <a href="https://github.com/feedhenry-raincatcher/raincatcher-portal/blob/master/src/app/main.js">main.js</a> in location <em>/src/app/</em></p>
</li>
<li>
<p>Disable Passport.js and require Keycloak</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">  require('./keycloak')</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Ensure that Passport.js is disabled by not requiring ./passport.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="{context}-accessing-the-keycloak-admin-console">13.3.6. Accessing the Keycloak Admin Console</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To access the <em>Keycloak Admin Console</em>, navigate to <em><a href="http://localhost:8080/auth/" class="bare">http://localhost:8080/auth/</a></em></p>
<div class="paragraph">
<p>See <a href="#{context}-credentials-for-the-demo-application">Credentials for the Admin Console</a> section
to see the credentials used by the Keycloak docker image.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For more information about the admin console, see Keycloak <a href="http://www.keycloak.org/docs/latest/server_admin/topics/admin-console.html">admin console</a> documentation.</p>
</div>
</div>
<div class="sect3">
<h4 id="{context}-keycloak-configuration-production">13.3.7. Keycloak Configuration for Production Environments</h4>
<div class="paragraph">
<p>The provided Keycloak realm is configured for local development only. Ensure that you provide proper configurations
for production environments.</p>
</div>
<div class="paragraph">
<p>For more information on Keycloak server administration, see the <a href="http://www.keycloak.org/docs/latest/server_admin/index.html">server administration</a> documentation.</p>
</div>
<h5 id="_client_configurations" class="discrete">Client Configurations</h5>
<div class="paragraph">
<p>The existing Keycloak realm provides three clients for the server, mobile and portal applications. These three clients
are using <a href="http://www.keycloak.org/docs/latest/server_admin/topics/sso-protocols/oidc.html">OpenID Connect</a> authentication protocol.
Ensure that these clients are configured properly to be secure for production environments.</p>
</div>
<div class="paragraph">
<p>For more information, see the Keycloak <a href="http://www.keycloak.org/docs/latest/server_admin/topics/clients/client-oidc.html">OpenID Connect Client Configurations</a> documentation.</p>
</div>
<h5 id="_user_configuration" class="discrete">User Configuration</h5>
<div class="paragraph">
<p>The existing Keycloak realm is configured with sample users. Ensure that you provide proper user and user storage configuration when moving to production environments.</p>
</div>
<div class="paragraph">
<p>For more information on user management, see Keycloak <a href="http://www.keycloak.org/docs/latest/server_admin/topics/users.html">User Management</a> documentation.
For more information on user storage federations, see Keycloak <a href="http://www.keycloak.org/docs/latest/server_admin/topics/user-federation.html">User Federation</a> documentation.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="{context}-pro-keycloak-implementation">13.4. Implementing Keycloak</h3>
<div class="sect3">
<h4 id="_prerequisites_5">13.4.1. Prerequisites</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure you have completed <a href="#getting-started">Getting Started</a></p>
</li>
<li>
<p>A Keycloak server</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_using_keycloak_to_secure_express_endpoints">13.4.2. Using Keycloak to secure Express endpoints</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The RainCatcher applications uses the Keycloak Node.js and Javascript Client Adapters. For more information,
see <a href="#{context}-understanding-keycloak-client-adapters">Understanding Keycloak Client Adapters</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="{context}-implement-endpointsecurity-interface">13.4.3. Implement the EndpointSecurity Interface</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Import the <a href="../../../api/1.0.0/express-auth/docs/interfaces/_src_endpointsecurity_.endpointsecurity.html">EndpointSecurity Interface</a>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-typescript" data-lang="typescript">import { EndpointSecurity } from '@raincatcher/express-auth';</code></pre>
</div>
</div>
</li>
<li>
<p>Implement the EndpointSecurity interface</p>
<div class="paragraph">
<p>See the sample <a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/src/modules/keycloak/index.ts">Keycloak implementation</a> of
the EndpointSecurity interface as a reference on how this can be implemented.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="{context}-enable-keycloak-security-middleware">13.4.4. Enable Keycloak Security Middleware for Route Protection</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Instantiate Keycloak and install the Keycloak middleware to your express app.</p>
<div class="paragraph">
<p>This is implemented in the <a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/src/modules/keycloak/index.ts">Keycloak implementation</a>
within the init function.</p>
</div>
</li>
<li>
<p>Apply this init which returns the Keycloak security middleware to be used for protecting express routes.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-typescript" data-lang="typescript">import { init as initKeycloak } from './keycloak';
...
const securityMiddleware = initKeycloak(app);</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/src/modules/index.ts">security setup</a> as a reference on how this can be applied.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>For more information on how to setup the Keycloak Node.js Adapter, see the <a href="http://www.keycloak.org/docs/latest/securing_apps/topics/oidc/nodejs-adapter.html">Node.js Adapter documentation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="{context}-protect-express-routes">13.4.5. Protect Express Routes</h4>
<div class="paragraph">
<p>The following code is an example of how to protect routes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-typescript" data-lang="typescript">// This implementation supports role based authentication
app.use('/test', securityMiddleware.protect(role));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The RainCatcher server application includes configurable admin and user roles within its <a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/config-dev.js#L13-L14">security configuration</a>.
This is used by the server application <a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/src/modules/index.ts">security setup</a>.
See the <a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/src/modules/index.ts">security setup</a> as a reference on how routes can be protected.</p>
</div>
<div class="paragraph">
<p>For more information on protecting express routes, see the <a href="http://www.keycloak.org/docs/latest/securing_apps/topics/oidc/nodejs-adapter.html">Node.js Adapter documentation</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_passport_js">14. Using Passport.js</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="{context}-con-passportauth-module">14.1. Introducing the RainCatcher PassportAuth Module</h3>
<div class="paragraph">
<p>The <strong>RainCatcher <a href="https://github.com/feedhenry-raincatcher/raincatcher-core/tree/master/cloud/passportauth">PassportAuth</a></strong> module is <strong>RainCatcher&#8217;s</strong> implementation of <strong>Passport.js</strong>.
It is the default authentication and authorization module for <strong>RainCatcher</strong>.</p>
</div>
<div class="paragraph">
<p><strong>PassportAuth</strong> provides pluggable authentication using <a href="http://passportjs.org/docs/configure">strategies</a>.
<strong>Passport.js</strong> offers a comprehensive set of strategies that support authentication using a username and password, existing social media and other 3rd party accounts, and more.</p>
</div>
<div class="paragraph">
<p><strong>PassportAuth</strong> provides:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access Control of Express routes</p>
</li>
<li>
<p>Authentication using the <a href="../../../api/1.0.0/auth-passport/docs/modules/_src_auth_defaultstrategies_.html">default strategies</a></p>
</li>
<li>
<p>Express session middleware using <a href="https://github.com/expressjs/session">express-session</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="{context}-con-passportauth-securitystrategy">14.2. Introducing the Security Strategy for PassportAuth</h3>
<div class="paragraph">
<p>The <strong>RainCatcher PassportAuth</strong> Security Strategy describes the security aspects for <strong>PassportAuth</strong> and covers areas such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Understanding Session Management</p>
</li>
<li>
<p>Defining Access Control</p>
</li>
<li>
<p>Defining Password Storage</p>
</li>
<li>
<p><strong>PassportAuth</strong> Authentication</p>
</li>
<li>
<p><strong>PassportAuth</strong> Authorization</p>
</li>
<li>
<p>Customizing a Strategy</p>
</li>
<li>
<p><strong>PassportAuth</strong> Demo Users and Access Roles</p>
</li>
<li>
<p><strong>PassportAuth</strong> Login Pages</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="{context}-ref-passportauth-securitystrategy">14.2.1. Defining the Security Strategy for RainCatcher PassportAuth</h4>
<h5 id="{context}-understanding-passportauth-session-management" class="discrete">Understanding PassportAuth Session Management</h5>
<div class="paragraph">
<p>The <em>express-session</em> module provides session management functionality for <strong>PassportAuth</strong>.
For more information, see <a href="https://github.com/expressjs/session">express-session</a>.</p>
</div>
<h5 id="{context}-defining-passportauth-access-control" class="discrete">Defining PassportAuth Access Control</h5>
<div class="paragraph">
<p><em>Routes</em> are protected by <strong>PassportAuth</strong> which provides role based access control.
<em>AuthService</em> is an an implementation of <a href="../../../raincatcher-docs/1.0.0/auth-passport/docs/classes/_src_auth_passportauth_.passportauth.html">PassportAuth</a>.
For more information, see the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-typescript" data-lang="typescript">app.get('/testAdminEndpoint', authService.protect('admin'), (req: express.Request, res: express.Response) =&gt; {
  res.json({ routeName: '/testAdminEndpoint', msg: 'authorized to access admin endpoint' });
});</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Demo roles are defined in <a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/src/modules/passport-auth/users.json">users.json</a>.
</td>
</tr>
</table>
</div>
<h5 id="{context}-defining-passportauth-password-storage" class="discrete">Defining PassportAuth Password Storage</h5>
<div class="paragraph">
<p>The <strong>PassportAuth</strong> user data is stored in a <em>User Repository</em>. Make sure that the <a href="../../../api/1.0.0/auth-passport/docs/interfaces/_src_user_userrepository_.userrepository.html#getuserbylogin">User Repository Interface</a>
is implemented in order to point <strong>PassportAuth</strong> to a datasource.</p>
</div>
<h5 id="{context}-passportauth-authentication" class="discrete">PassportAuth Authentication</h5>
<div class="paragraph">
<p>RainCatcher authentication is handled by the server using the user&#8217;s unique username and password combination.
The <strong>PassportAuth</strong> service has a default authentication strategy based on <strong>Passport.js</strong>'s local and JWT strategies.</p>
</div>
<div class="paragraph">
<p><strong>PassportAuth</strong> uses <a href="../../../api/1.0.0/auth-passport/docs/classes/_src_auth_passportauth_.passportauth.html#authenticate">authenticate</a>
middleware for cookie based authentication. To access <em>express</em> routes,
a user must login using their credentials. A cookie containing a user session key is used to authenticate and
authorize a user upon each request to the server.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In the Demo Applications, the cookie login route has an <strong>authenticate()</strong> method that checks user credentials
against the stored credentials in the <em>users.json</em> file. It also checks the user&#8217;s role against the role on <em>users.json</em>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>PassportAuth</strong> uses <a href="../../../api/1.0.0/auth-passport/docs/classes/_src_auth_passportauth_.passportauth.html#authenticatewithtoken">authenticateWithToken</a>
for token based authentication. To access <em>express</em> routes, a user must login using their credentials. A generated JSON web token (JWT)
and the user&#8217;s profile is sent to the client upon successful authentication.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The JWT token needs to be included in every subsequent request after a successful login as part of the <strong>Authorization</strong> header
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more information, see the <a href="https://github.com/feedhenry-raincatcher/raincatcher-core/tree/master/cloud/passportauth/example">PassportAuth example</a>.</p>
</div>
<h5 id="{context}-passportauth-authorization" class="discrete">PassportAuth Authorization</h5>
<div class="paragraph">
<p>Authorization is supported by <a href="../../../api/1.0.0/express-auth/docs/interfaces/_src_endpointsecurity_.endpointsecurity.html">protect middleware</a> that validates a session or a JWT token depending on
the <strong>Passport.js</strong> strategy used and checks if the user has the required role.</p>
</div>
<h5 id="{context}-customizing-a-strategy" class="discrete">Customizing a Strategy</h5>
<div class="paragraph">
<p>The default strategies for the <strong>PassportAuth</strong> module implements the <strong>Passport.js</strong> local and JWT strategy.
To customize the existing strategies, override the <a href="../../../api/1.0.0/auth-passport/docs/classes/_src_auth_passportauth_.passportauth.html#setupcookie">PassportAuth.setupCookie</a> or
<a href="../../../api/1.0.0/auth-passport/docs/classes/_src_auth_passportauth_.passportauth.html#setuptoken">PassportAuth.setupToken</a> method.
To use a different security strategy that is supported by <strong>Passport.js</strong>, override the <a href="../../../api/1.0.0/auth-passport/docs/classes/_src_auth_passportauth_.passportauth.html#init">PassportAuth.init</a> method.</p>
</div>
<h5 id="{context}-passportAuth-demo-users-and-access-roles" class="discrete">PassportAuth Demo Users and Access Roles</h5>
<div class="paragraph">
<p><strong>PassportAuth</strong> is by default integrated with the Demo application and contains sample users and access roles which
are defined in the <a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/src/modules/passport-auth/users.json">demo data</a> JSON file.</p>
</div>
<h5 id="{context}-customizing-passportauth-ui" class="discrete">PassportAuth Login Pages</h5>
<div class="paragraph">
<p>For more information on how to customize the login pages used by PassportAuth, see <a href="#{context}-customizing-passportauth-login-ui">Customizing PassportAuth Login UI</a>
section.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="{context}pro-passportauth-enablement">14.3. Enabling PassportAuth</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Passport.js is the default auth provider for the RainCatcher applications and is enabled by default
in all of the RainCatcher applications. The following steps are only valid if PassportAuth has been disabled to enable Keycloak.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_prerequisites_6">14.3.1. Prerequisites</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure you have completed <a href="#getting-started">Getting Started</a></p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_enabling_passportauth_on_the_raincatcher_applications">14.3.2. Enabling PassportAuth on the RainCatcher Applications</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
In order to enable PassportAuth in the RainCatcher applications, Keycloak must be disabled.
</td>
</tr>
</table>
</div>
<h5 id="_enabling_passportauth_on_the_server_application" class="discrete">Enabling PassportAuth on the Server Application</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the Keycloak configuration in the server application is not filled in.</p>
<div class="paragraph">
<p>There are two configuration files available in the server application:
<a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/config-dev.js">config-dev</a> and
<a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/config-prod.js">config-prod</a>.</p>
</div>
<div class="paragraph">
<p>Ensure that the values for realm, auth-server-url and resource properties are empty within the Keycloak configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">  "keycloak": {
    "realm": "",
    "bearer-only": true,
    "auth-server-url": "",
    "ssl-required": "external",
    "resource": "",
    "use-resource-role-mappings": true
  }</code></pre>
</div>
</div>
</li>
</ol>
</div>
<h5 id="_enabling_passportauth_on_the_portal_application" class="discrete">Enabling PassportAuth on the Portal Application</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the file <a href="https://github.com/feedhenry-raincatcher/raincatcher-portal/blob/master/src/app/main.js">main.js</a> in location <em>/src/app/</em></p>
</li>
<li>
<p>Disable Keycloak and require PassportAuth</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">  require('./passport')</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The login page used by PassportAuth in the portal application is served by the server application. For more infromation
on how to customize this login page, see the <a href="#{context}-customizing-passportauth-login-ui">Customizing PassportAuth Login UI</a> section.
</td>
</tr>
</table>
</div>
<h5 id="_enabling_passportauth_on_the_mobile_application" class="discrete">Enabling PassportAuth on the Mobile Application</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the file <a href="https://github.com/feedhenry-raincatcher/raincatcher-mobile/blob/master/src/app/app.js">app.js</a> in location <em>/src/app/</em></p>
</li>
<li>
<p>Disable Keycloak and require PassportAuth</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">  require('./passport'),
  require('@raincatcher/angularjs-auth')()</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Ensure to enable the <a href="https://github.com/feedhenry-raincatcher/raincatcher-angularjs/tree/master/packages/angularjs-auth">@raincatcher/angularjs-auth</a> module
along with the PassportAuth module. This package contains the AngularJS implementation of the login page used by PassportAuth
for the mobile application. For more information on how to customize the PassportAuth login page used by the mobile
application, see the <a href="#{context}-customizing-passportauth-login-ui">Customizing PassportAuth Login UI</a> section.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="{context}-pro-passportauth-implementation">14.4. Implementing PassportAuth</h3>
<div class="sect3">
<h4 id="_prerequisites_7">14.4.1. Prerequisites</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure you have completed <a href="#getting-started">Getting Started</a></p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="{context}-pro-passportauth-pointing-to-a-datasource">14.4.2. Pointing PassportAuth to a Datasource</h4>
<div class="paragraph">
<p>The default PassportAuth implementation uses a JSON file which contains a set of
<a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/src/modules/passport-auth/users.json">sample users</a> for demo purposes.
The following steps describes how to replace the current set of users by pointing to a different user datasource.</p>
</div>
<h5 id="_implement_the_userrepository_interface" class="discrete">Implement the UserRepository Interface</h5>
<div class="paragraph">
<p>The <a href="../../../api/1.0.0/auth-passport/docs/interfaces/_src_user_userrepository_.userrepository.html">UserRepository Interface</a> needs to be
implemented in order to retrieve user related data from a data source.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Import the <a href="../../../api/1.0.0/auth-passport/docs/interfaces/_src_user_userrepository_.userrepository.html">UserRepository Interface</a>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-typescript" data-lang="typescript">import { UserRepository } from '@raincatcher/auth-passport';</code></pre>
</div>
</div>
</li>
<li>
<p>Implement the UserRepository Interface.</p>
<div class="paragraph">
<p>See the sample <a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/src/modules/passport-auth/DemoUserRepository.ts">UserRepository implementation</a>
as a reference on how this can be implemented.</p>
</div>
</li>
</ol>
</div>
<h5 id="_implement_the_userservice_interface" class="discrete">Implement the UserService Interface</h5>
<div class="paragraph">
<p>The <a href="./../../api/1.0.0/auth-passport/docs/interfaces/_src_user_userservice_.userservice.html">UserService Interface</a> defines a set of requirements
for mapping specific fields from the user data that is returned from the UserRepository.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Import the <a href="./../../api/1.0.0/auth-passport/docs/interfaces/_src_user_userservice_.userservice.html">UserService Interface</a>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-typescript" data-lang="typescript">import { UserService } from '@raincatcher/auth-passport';</code></pre>
</div>
</div>
</li>
<li>
<p>Implement the UserService Interface</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
The UserService Interface contains a <a href="./../../api/1.0.0/auth-passport/docs/interfaces/_src_user_userservice_.userservice.html#getprofile">getProfile()</a> function,
which is used to retrieve the user&#8217;s profile data. Ensure that any sensitive data is filtered out before returning
the user&#8217;s profile data.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See the sample <a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/src/modules/passport-auth/DemoUserRepository.ts">UserService implementation</a>
as a reference on how this can be implemented.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="{context}-enable-passportauth">14.4.3. Enable PassportAuth for Route Protection</h4>
<h5 id="_prerequisites_8" class="discrete">Prerequisites</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure you have the <a href="#{context}-pro-passportauth-pointing-to-a-datasource">Pointing to a Datasource</a> step completed</p>
</li>
</ol>
</div>
<h5 id="_set_up_a_passportauth_service" class="discrete">Set up a PassportAuth Service</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Instantiate a UserRepository and UserService to be used by PassportAuth</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-typescript" data-lang="typescript">  const userRepo: UserRepository = new YourUserRepository();
  const userService: UserService = new YourUserService();</code></pre>
</div>
</div>
</li>
<li>
<p>Instantiate PassportAuth to be used for Route Protection</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-typescript" data-lang="typescript">  const authService: PassportAuth = new PassportAuth(userRepo, userService);</code></pre>
</div>
</div>
</li>
</ol>
</div>
<h5 id="_initialize_a_passportauth_service" class="discrete">Initialize a PassportAuth Service</h5>
<div class="paragraph">
<p>PassportAuth can be initialized in two different ways depending on what Passport.js strategy you would like to use.</p>
</div>
<div class="paragraph">
<p>For more information on PassportAuth init function, see PassportAuth
<a href="./../../api/1.0.0/auth-passport/docs/classes/_src_auth_passportauth_.passportauth.html#init">init()</a> documentation.</p>
</div>
<h6 id="_initialize_passportauth_to_use_the_local_strategy" class="discrete">Initialize PassportAuth to use the Local Strategy</h6>
<div class="paragraph">
<p>Passport.js <a href="https://github.com/jaredhanson/passport-local">local strategy</a> is used for authenticating with a username and password.
In RainCatcher, this strategy is used to authenticate users in the portal application by default.</p>
</div>
<div class="paragraph">
<p>In order to configure PassportAuth to use the local strategy, the following steps needs to be completed:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Define express session options to be used with PassportAuth for session management</p>
<div class="paragraph">
<p>Express session is used to provide session support for PassportAuth. In RainCatcher, the session options are
defined in the <a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/config-dev.js">config-dev</a> and the
<a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/config-prod.js">config-prod</a> configuration files in the server application.</p>
</div>
<div class="paragraph">
<p>For more information on express session options, see the <a href="https://github.com/expressjs/session">express-session</a> documentation.</p>
</div>
</li>
<li>
<p>Initialize PassportAuth</p>
<div class="paragraph">
<p>PassportAuth needs to be initialized with an express router and the express session options you have
defined in the previous step.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-typescript" data-lang="typescript">  authService.init(expressRouter, yourSessionOptions);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information on PassportAuth local strategy implementation, see PassportAuth
<a href="./../../api/1.0.0/auth-passport/docs/modules/_src_auth_defaultstrategies_.html#webstrategy">web strategy</a> documentation.</p>
</div>
</li>
</ol>
</div>
<h6 id="_initialize_passportauth_to_use_the_jwt_strategy" class="discrete">Initialize PassportAuth to use the JWT Strategy</h6>
<div class="paragraph">
<p>Passport.js <a href="https://github.com/themikenicholson/passport-jwt">JWT strategy</a> is used to authenticate a user
with a <a href="https://jwt.io/">JSON Web Token</a>. In RainCatcher, this strategy is used to authenticate users
in the mobile application by default.</p>
</div>
<div class="paragraph">
<p>In order to configure PassportAuth to use the JWT strategy, the following steps needs to be completed:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Generate a secret to be used for signing the JSON Web Token.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
The secret is used to sign a JSON Web Token. Ensure to provide a secure secret in order to prevent
attackers from carrying out unauthorized actions.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In RainCatcher, the secret used for the JWT strategy is defined in the <a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/config-dev.js">config-dev</a> and the
<a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/config-prod.js">config-prod</a> configuration files in the server application.</p>
</div>
</li>
<li>
<p>Initialize PassportAuth</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Passport.js JWT Strategy does not require session support, therefore it should not pass any session options.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>PassportAuth needs to be initialized with an express router and the secret you have defined in the previous step.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-typescript" data-lang="typescript">  authService.init(expressRouter, undefined, yourSecret);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information on PassportAuth JWT strategy implementation, see PassportAuth
<a href="./../../api/1.0.0/auth-passport/docs/modules/_src_auth_defaultstrategies_.html#jwtstrategy">JWT strategy</a> documentation.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="{context}-passportauth-protect-routes">14.4.4. Using the PassportAuth Middleware for Route Protection</h4>
<h5 id="_prerequisites_9" class="discrete">Prerequisites</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure you have the <a href="#{context}-enable-passportauth">Enable PassportAuth for Route Protection</a> step completed.</p>
</li>
</ol>
</div>
<h5 id="_passportauth_authentication" class="discrete">PassportAuth Authentication</h5>
<div class="paragraph">
<p>Authentication with PassportAuth can be done in two different ways depending on the strategy used. For more information
on Authenticating with PassportAuth, see <a href="#{context}-passportauth-authentication">PassportAuth Authentication</a> section.</p>
</div>
<h6 id="_authenticate_using_local_strategy" class="discrete">Authenticate using Local Strategy</h6>
<div class="paragraph">
<p>PassportAuth wraps the Passport.js <a href="http://passportjs.org/docs/authenticate">authenticate</a> middleware in
PassportAuth&#8217;s authenticate() function.</p>
</div>
<div class="paragraph">
<p>The following code is an example of how to authenticate using PassportAuth local strategy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-typescript" data-lang="typescript">  router.post('/login', authService.authenticate('local', {
    successReturnToOrRedirect: '/',
    failureRedirect: '/loginError'
  }));</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information on PassportAuth authenticate() functionality, see PassportAuth <a href="./../../api/1.0.0/auth-passport/docs/classes/_src_auth_passportauth_.passportauth.html#authenticate">authenticate()</a>
documentation.</p>
</div>
<h6 id="_authenticate_using_jwt_strategy" class="discrete">Authenticate using JWT Strategy</h6>
<div class="paragraph">
<p>PassportAuth provides an authentication middleware for authenticating with the Passport.js JWT strategy. The
following code is an example of how to authenticate using PassportAuth JWT strategy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-typescript" data-lang="typescript">  router.post('/login', authService.authenticateWithToken(yourSecret, userService, userRepo));</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The JWT token needs to be included in each subsequent requests after a successful login as part of the Authorization header
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more information on PassportAuth authenticateWithToken() functionality, see PassportAuth
<a href="./../../api/1.0.0/auth-passport/docs/classes/_src_auth_passportauth_.passportauth.html#authenticatewithtoken">authenticateWithToken()</a> documentation.</p>
</div>
<h5 id="_protecting_express_routes" class="discrete">Protecting Express Routes</h5>
<div class="paragraph">
<p>PassportAuth provides a protect middleware for protecting routes from unauthenticated and unauthorized
requests. The following code is an example of how to protect express routes using PassportAuth:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-typescript" data-lang="typescript">  // This implementation supports role based authentication
  app.use('/test', securityMiddleware.protect(role));</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information on PassportAuth protect() functionality, see PassportAuth
<a href="./../../api/1.0.0/auth-passport/docs/classes/_src_auth_passportauth_.passportauth.html#protect">protect()</a> documentation.</p>
</div>
</div>
</div>
</div>
</div>
<h1 id="_logging" class="sect0">Logging</h1>
<div class="openblock partintro">
<div class="content">
<div id="{context}-con-logging" class="paragraph">
<p><strong>RainCatcher Logger</strong> creates logging facade for JavaScript based applications that
is used by all RainCatcher modules. Developers can use custom loggers by wrapping their implementation into the provided logger interface.</p>
</div>
<div class="paragraph">
<p>For more information about the <em>logger interface</em> structure, see <a href="../../../api/1.0.0/logger/docs/index.html">logger api documentation</a></p>
</div>
<div class="paragraph">
<p>The <strong>RainCatcher</strong> demo application contains two implementations of the <em>logger interface</em> a</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BunyanLogger</code>
Implements <a href="https://www.npmjs.com/package/bunyan">Bunyan</a>. Used for server side logging.</p>
</li>
<li>
<p><code>ClientLogger</code>
Implements <a href="https://github.com/pimterry/loglevel">LogLevel</a>. Used for client (web and mobile) logging.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To see a logging example, see the <a href="https://github.com/feedhenry-raincatcher/raincatcher-core/blob/master/common/logger/example/index.ts">Cloud Logger example</a>.</p>
</div>
</div>
</div>
<h1 id="ui" class="sect0">Modifying the UI</h1>
<div class="sect1">
<h2 id="{context}-ref-ui-technology">15. The Technology and Structure of the User Interface in a RainCatcher Project</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The User Interface of RainCatcher consists of a series of modules made available through the public NPM registry and built as modules the <a href="https://angularjs.org/">AngularJS Framework</a>.</p>
</div>
<div class="sect2">
<h3 id="_ui_frameworks">15.1. UI Frameworks</h3>
<div class="paragraph">
<p>The RainCatcher modules are intended to be used as part of a regular AngularJS application and used by it as <a href="https://docs.angularjs.org/guide/module">AngularJS modules</a>.</p>
</div>
<div class="paragraph">
<p>RainCatcher also utilizes <a href="https://material.angularjs.org/latest/">Angular Material</a> extensive as both a set of widgets and for achieving a consistent design philosophy.</p>
</div>
</div>
<div class="sect2">
<h3 id="_styling">15.2. Styling</h3>
<div class="paragraph">
<p>RainCatcher supplies <a href="http://sass-lang.com/">SASS</a> files with every module, allowing users to take advantage of its features to quickly customize the look and feel of the modules by simply defining and altering simple variables in the stylesheets.</p>
</div>
</div>
<div class="sect2">
<h3 id="_mobile_app_tooling">15.3. Mobile app tooling</h3>
<div class="paragraph">
<p>In addition to being a regular AngularJS application, the Mobile Starter App uses <a href="https://cordova.apache.org/">Apache Cordova</a> project to interface with the device&#8217;s native resources. This setup allows for simple testability without requiring any actual mobile devices or emulators until the latest stages in the development cycle.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="{context}-con-extending-the-user-interface">16. Extending the User Interface</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RainCatcher framework provides a set of extension points that allows a developer to modify an Angular User Interface (UI).
You can modify the UI by writing additional modules that provide a set of the Angular.js directives to extend the Mobile and Portal UI.
The RainCatcher Application is shipped with the <code>angularjs-extensions</code> example that extends the Mobile and Portal Applications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/feedhenry-raincatcher/raincatcher-angularjs/tree/master/packages/angularjs-extensions" class="bare">https://github.com/feedhenry-raincatcher/raincatcher-angularjs/tree/master/packages/angularjs-extensions</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This Module contains the example directives that are used for demo purposes and it can be used as a template to extend the existing RainCatcher UI.</p>
</div>
<div class="sect2">
<h3 id="_extending_the_workorders_ui">16.1. Extending the Workorders UI</h3>
<div class="paragraph">
<p>By default, RainCatcher provides a minimal set of defined fields for a <em>workorder</em>.
If your step results contain additional data, for example, gps location, an address or a description UI element, you probably want to extend the workorders UI to display that data.</p>
</div>
<div class="sect3">
<h4 id="_building_directives">16.1.1. Building Directives</h4>
<div class="paragraph">
<p>To extend a <em>workorder</em>, implement two Angular Directives:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 11. Angular Directives for Extending a <em>workorder</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Angular Directive</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>workorder-data</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Data directive used to implement static fields that display data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>workorder-data-edit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Data-edit directive used to implement fields that allow modifications to be made to a <em>workorder&#8217;s</em> data.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Directives operate (with respect to existing fields) outside of a <em>workorder</em> to avoid naming conflicts, for example, <code>workorder.data.yourcustomfield</code>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_user_interface">16.2. User Interface</h3>
<div class="paragraph">
<p>Include any required additional styles or libraries in the top level application.
The Mobile and Portal Applications contain standard bootstrap and Angular material directives and are located in the top level of the application.
For more information, see the <a href="https://material.angularjs.org/latest/api">Latest API</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_development_of_a_template">16.3. Development of a template</h3>
<div class="paragraph">
<p>To build a template, use <code>grunt wfmTemplate:build</code>.
To rebuild a template after making changes to it, use <code>grunt wfmTemplate:watch</code>.
Each change to a template requires a distribution build.</p>
</div>
</div>
<div class="sect2">
<h3 id="_integration">16.4. Integration</h3>
<div class="paragraph">
<p>An <em>Entry File</em> exposes a new implementation of an Angular module, mount it in a root application module.
Integrate any new NPM modules into both the Mobile and the Portal Application, so that the User can view the data belonging to the revised <em>workorder</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The RainCatcher Application contains the <code>@raincatcher-examples/angularjs-extensions</code> module. If you require a new custom module, remove the RainCatcher Application to avoid collisions.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_publishing">16.5. Publishing</h3>
<div class="paragraph">
<p>For RainCatcher to consume a module, best practice is to ensure that the module is published to the public or private NPM registry.
When publishing a custom module, ensure that the package&#8217;s name and the author&#8217;s name are updated.
If you choose not to publish a custom module, you can include all directives directly in the RainCatcher application.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="{context}-pro-ui-customization">17. RainCatcher UI App Customization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Follow these procedures to start applying changes to the Mobile and Portal Apps. Refer to the <a href="#{context}-ref-demo-app">RainCatcher Application Reference Material</a> for more information about their overall structure.</p>
</div>
<div class="sect2">
<h3 id="{context}-adding-ui-elements">17.1. Adding UI elements</h3>
<div class="sect3">
<h4 id="{context}-create-angularjs-module">17.1.1. Creating your own AngularJS module with routing</h4>
<div class="paragraph">
<p>In order to add new elements to the RainCatcher UI, you must create your own AngularJS module and add it to the array of dependencies of the main application module.</p>
</div>
<div class="paragraph">
<p>RainCatcher utilizes <a href="https://ui-router.github.io/ng1/">UI-Router for AngularJS</a> to modularize the user interface components in separate routes that can be referenced by navigation links.</p>
</div>
<div class="paragraph">
<p>The Applications follow a 2-column module in the case of the Portal App, and a single column plus an optional toolbar section in the case of the Mobile App. The applications can provide the HTML ids of these container elements to the individual modules, allowing them to insert views into them through the UI-Router.</p>
</div>
<div class="paragraph">
<p>The following is a tiny example of how a module can be structured:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">module.exports = function(config) {
  var moduleName = 'my-module';
  angular.module(moduleName, [])
  .config(['$stateProvider', function($stateProvider) {
    var views = {};
    views[config.mainColumnViewId] = {
      template: '&lt;p&gt;Hello from the custom module!&lt;/p&gt;'
    };

    if (config.listColumnViewId) {
      // optional for use in the portal app
      views[config.listColumnViewId] = {
        template: '&lt;p&gt;Hello from the list view for this route!&lt;/p&gt;'
      };
    }

    if (config.toolbarViewId) {
      // optional for use in the mobile app
      views[config.toolbarViewId] = {
        template: '&lt;p&gt;Hello from a toolbar for this route!&lt;/p&gt;'
      };
    }

    $stateProvider.state('app.custom', {
      url: '/custom',
      views: views
    });
  }]);

  return moduleName;
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your module should:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Export a function that receives a configuration object and returns the name of the module for convenience;</p>
</li>
<li>
<p>Utilize the UI-Router&#8217;s <code>$stateProvider</code> to include any new routes;</p>
</li>
<li>
<p>Define states that are nested states of <code>app</code> (<code>app.custom</code> in the above example), since otherwise the views in the custom state will replace the application&#8217;s entire interface instead of inserting their content in the containers. See <a href="https://github.com/angular-ui/ui-router/wiki/Nested-States-&amp;-Nested-Views">Nested States &amp; Nested Views</a> for more information.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Refer to the <a href="https://docs.angularjs.org/api/ng/function/angular.module">AngularJS Module documentation</a> for further information on creating new modules.</p>
</div>
</div>
<div class="sect3">
<h4 id="{context}-add-custom-module">17.1.2. Adding the new module to the main application config</h4>
<div class="paragraph">
<p>To configure the Apps to utilize your module, add it to the array of dependencies of the main <code>app</code> module for the App:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">angular.module('app', [
  //...
  require('./my-module')({
    listColumnViewId: "column2",
    mainColumnViewId: "content@app",
  }),
  //...
]);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the Mobile App, this is located at <code>src/app/app.js</code>.</p>
</div>
<div class="paragraph">
<p>For the Portal App, this is located at <code>src/app/main.js</code></p>
</div>
<div class="paragraph">
<p>At this point, running the App and navigating to <code>/custom</code> should navigate to the custom route and display the messages defined in the <code>template</code> keys in the <a href="#{context}-create-angularjs-module">previous section</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_new_navigation_option_on_the_navigation_sidebar">17.1.3. New navigation option on the navigation sidebar</h4>
<div class="paragraph">
<p>To add a navigation link to the new custom route on the main navigation sidebar, edit the <code>main.tpl.html</code> file (present on both Apps), and add a new <code>md-list-item</code> that utilizes the <code>navigateTo()</code> method that&#8217;s available on the main controllers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;md-list&gt;
  &lt;!-- ... Other navigation items --&gt;
  &lt;md-list-item ng-click="navigateTo('app.custom')" ng-class="{active: $state.includes('app.custom')}"&gt;
    &lt;md-icon md-font-set="material-icons"&gt;bookmark&lt;/md-icon&gt;
    &lt;p&gt;Custom link&lt;/p&gt;
  &lt;/md-list-item&gt;
  &lt;md-divider&gt;&lt;/md-divider&gt;
  &lt;!-- ... Other navigation items --&gt;
&lt;/md-list&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="https://material.angularjs.org/latest/api/directive/mdIcon">mdIcon</a> documentation for the list of icons that you can utilize with the new navigation item.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_customizing_sass_and_themes">17.2. Customizing SASS and Themes</h3>
<div class="paragraph">
<p>RainCatcher utilizes <a href="http://sass-lang.com/">SASS</a> in order to supply extra features on top of standard CSS. These files are entry point to customizing and adding new styles to the App&#8217;s interface.</p>
</div>
<div class="sect3">
<h4 id="_adding_extra_stylesheets">17.2.1. Adding extra Stylesheets</h4>
<div class="paragraph">
<p>In order to add new SASS files, simply include a new file in the <code>src/sass/</code> directory of your App and <code>@import</code> it from the App&#8217;s main <code>.scss</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scss" data-lang="scss">// In custom.scss
.my-class {
  color: #0000FF;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scss" data-lang="scss">// In the main .scss file
@import './custom.scss';</code></pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s recommended to include custom rules in new files and even use namespaced or prefixed class names to avoid collisions with updates in the RainCatcher codebase.</p>
</div>
</div>
<div class="sect3">
<h4 id="_changing_the_theme_of_raincatcher_components">17.2.2. Changing the theme of RainCatcher components</h4>
<div class="paragraph">
<p>RainCatcher components inherit their look and feel from global variables defined in the top section of main SASS file, by changing these values all elements will reflect the new values after the standard build process regenerates the compiled CSS files from them:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scss" data-lang="scss">$secondary-text-color: rgba(0,0,0,.54);
$divider-text-color: rgba(0,0,0,.12);

$white-text-color: rgba(255,255,255,1);
$white-secondary-text-color: rgba(255,255,255,.7);
$white-divider-color: rgba(255,255,255,.3);

$primary-color: #3F51B5;
$secondary-color: #303F9F;

$accent-color-1: #a63db8;
$accent-color-2: #4d5bb3;
$accent-color-3: #1aa094;
$accent-color-4: #283593;

$success: #388E3C;
$danger: #F44336;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_customizing_raincatcher_login_ui">17.3. Customizing RainCatcher Login UI</h3>
<div class="sect3">
<h4 id="{context}-customizing-passportauth-login-ui">17.3.1. Customizing PassportAuth Login UI</h4>
<h5 id="_customizing_the_passportauth_login_page_for_the_portal_application" class="discrete">Customizing the PassportAuth Login Page for the Portal Application</h5>
<div class="paragraph">
<p>The login page for PassportAuth in the portal application is served by the server application. It can be rendered like the following example below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-typescript" data-lang="typescript">res.render('login', {
  title: 'Your Title',
  message: 'Your Invalid Credentials Message'
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>The PassportAuth portal login page is fully customizable by configuring the <a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/views/login.hbs">login.hbs</a>
within the server application.</p>
</div>
<h5 id="_customizing_the_passportauth_login_page_for_the_mobile_application" class="discrete">Customizing the PassportAuth Login Page for the Mobile Application</h5>
<div class="paragraph">
<p>The <a href="https://github.com/feedhenry-raincatcher/raincatcher-angularjs/tree/master/packages/angularjs-auth">@raincatcher/angularjs-auth</a>
package contains the AngularJS implementation of the PassportAuth login page. This is used with the PassportAuth
module for the mobile application.</p>
</div>
<div class="paragraph">
<p>The package needs to be enabled along with the PassportAuth module within the mobile application. The title of the
login page can be specified by adding the title as a parameter to the module.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">require('./passport'),
require('@raincatcher/angularjs-auth')({
  title: 'Your Title Here'
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>The PassportAuth mobile login page can be customized by customizing the <a href="https://github.com/feedhenry-raincatcher/raincatcher-angularjs/blob/master/packages/angularjs-auth/lib/template/login.tpl.html">login page template</a>
in the <a href="https://github.com/feedhenry-raincatcher/raincatcher-angularjs/tree/master/packages/angularjs-auth">@raincatcher/angularjs-auth</a> module. Ensure that the templates are built by running the following command</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">grunt build</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_customizing_keycloak_login_ui">17.3.2. Customizing Keycloak Login UI</h4>
<div class="paragraph">
<p>The Keycloak login page can be customized by providing a custom theme for Keycloak. For more information on
how to provide your own custom theme for Keycloak, see the <a href="https://medium.com/@auscunningham/create-a-custom-theme-for-keycloak-8781207be604">Create a custom theme for Keycloak</a>
article.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_raincatcher_angularjs_modules">18. RainCatcher AngularJS modules</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes <strong>RainCatcher&#8217;s</strong> list of modules that are built to work with the <a href="https://angularjs.org/">AngularJS Framework</a>.
The latest list of modules is found at <a href="https://www.npmjs.com/org/raincatcher/">RainCatcher Modules</a>.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 12. RainCatcher AngularJS Modules</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Module</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/feedhenry-raincatcher/raincatcher-angularjs/tree/master/packages/angularjs-auth-keycloak">@raincatcher/angularjs-auth-keycloak</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The RainCatcher client-side authentication module for use with a KeyCloak back-end.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/feedhenry-raincatcher/raincatcher-angularjs/tree/master/packages/angularjs-auth-passport">@raincatcher/angularjs-auth-passport</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The RainCatcher client-side authentication module for use with a ExpressJS + <a href="passport.js"><a href="http://passportjs.org/" class="bare">http://passportjs.org/</a></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/feedhenry-raincatcher/raincatcher-angularjs/tree/master/packages/angularjs-auth">@raincatcher/angularjs-auth</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User Interface module for use with the authentication packages linked above.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/feedhenry-raincatcher/raincatcher-angularjs/tree/master/packages/angularjs-http">@raincatcher/angularjs-http</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data access module based on <a href="https://docs.angularjs.org/api/ng/service/$http">AngularJS&#8217;s $http</a> module.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/feedhenry-raincatcher/raincatcher-angularjs/tree/master/packages/angularjs-workflow">@raincatcher/angularjs-workflow</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The RainCatcher User Interface package for rendering Work Flows</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/feedhenry-raincatcher/raincatcher-angularjs/tree/master/packages/angularjs-workorder">@raincatcher/angularjs-workorder</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The RainCatcher User Interface package for rendering Work Orders</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/feedhenry-raincatcher/raincatcher-angularjs/tree/master/packages/angularjs-extensions">@raincatcher/angularjs-extensions</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extra AngularJS directives to attach and display extra data in Work Orders.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/feedhenry-raincatcher/raincatcher-angularjs/tree/master/steps/examples/step-accident">@raincatcher/step-accident</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Example RainCatcher Step for an accidental crash with a motor vehicle scenario.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/feedhenry-raincatcher/raincatcher-angularjs/tree/master/steps/examples/step-vehicle-inspection">@raincatcher/step-vehicle-inspection</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Example RainCatcher Step for a vehicle inspection scenario.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/feedhenry-raincatcher/raincatcher-angularjs/tree/master/steps/step-signature">@raincatcher/angularjs-signature</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Example RainCatcher Step for capturing a user&#8217;s signature as a bitmap.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<h1 id="performance" class="sect0">Production setup</h1>
<div class="sect1">
<h2 id="{context}-production-checklist">19. Production checklist</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Following guide provides set of guidance and actions that needs to be verified before releasing ${PRODUCT_NAME} to production.</p>
</div>
<div class="sect2">
<h3 id="_server_configuration">19.1. Server configuration</h3>
<div class="paragraph">
<p>Server application provides abstraction for configuration that allows users to create profiles.
Application is created with 2 default profiles:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>development (<a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/config-dev.js">config-dev.js</a>)</p>
</li>
<li>
<p>production (<a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/config-prod.js">config-prod.js</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information about profiles go to <a href="{context}-ref-server">Server side reference</a></p>
</div>
<div class="paragraph">
<p>When moving to production developers should review their configuration to make sure that a</p>
</div>
<div class="paragraph">
<p>Most important areas to review:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>MongoDB configuration pooling</p>
</li>
<li>
<p>Redis configuration</p>
</li>
<li>
<p>Session</p>
</li>
<li>
<p>Security tokens</p>
</li>
<li>
<p>Application logging</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Most important values</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>seedDemoData</code> (disable demo data by false)</p>
</li>
<li>
<p><code>passportjs.jwtSecret</code>: secret value used with Passportjs</p>
</li>
<li>
<p><code>session.secret</code>: secret value for the session</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Configuration contains critical elements for application security.
Please make sure that you not going to use any default values from the profile provided with server application.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Please follow integrations documentation for more details about specific sections of the configuration</p>
</div>
</div>
<div class="sect2">
<h3 id="_mobile_application">19.2. Mobile application</h3>
<div class="paragraph">
<p>Mobile configuration should be adjusted before building mobile application.
Configuration can be found <a href="https://github.com/feedhenry-raincatcher/raincatcher-mobile/blob/master/src/config.json">config.json file</a></p>
</div>
<div class="paragraph">
<p>Developers can adjust sync options improve overall performance.
For more information see <a href="con-performance-guidelines.adoc">Performance Guide</a>
Additionally Keycloak configuration can be changed.</p>
</div>
<div class="paragraph">
<p>Most important values</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sync_frequency</code>: can be used to adjust time sync framework will pool the server)</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_cordova_configuration">19.2.1. Cordova configuration</h4>
<div class="paragraph">
<p>Apache Cordova configuration needs to be adjusted before doing release.
Configuration can be found in <a href="https://github.com/feedhenry-raincatcher/raincatcher-mobile/blob/master/src/config.xml">Cordova config.xml file</a>
Developers should review Cordova file by removing permissions and plugins that aren&#8217;t used.
Additionally developers should restrict and remove any origins that aren&#8217;t used in the application</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;!--Remove wildcard--&gt;
&lt;access origin="*" /&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_portal_configuration">19.3. Portal configuration</h3>
<div class="paragraph">
<p>Portal configuration can be found <a href="https://github.com/feedhenry-raincatcher/raincatcher-portal/blob/master/src/config.json">config.json file</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_remove_redundant_code_from_all_applications">19.4. Remove redundant code from all applications</h3>
<div class="paragraph">
<p>RainCatcher reference applications including all npm modules that are available as part of the solution.
Depending on use case developers can choose to use different technologies.
Before moving to production any redundant code and npm modules should be removed from <code>package.json</code></p>
</div>
<div class="paragraph">
<p>Please follow individual application documentation to see what elements can be removed.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="{context}-performance-guidelines">20. Performance Guidelines</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RainCatcher integrates multiple technologies and frameworks into single solution. Developers can build on top of the provided applications and use technologies that aren&#8217;t part of the standard applications.</p>
</div>
<div class="paragraph">
<p>Node.js based server can rely on customer preferred database or external API. This  may have significant impact on overall application performance. RainCatcher was designed to expose all configuration into single files.
Thanks to that developers can move applications to production by changing configuration in one place.</p>
</div>
<div class="paragraph">
<p>Server side application supports profiles (by default development and production) that will also help to differentiate between production and development configuration. This will ensure that application will be secure and perform to growing number of users.</p>
</div>
<div class="sect2">
<h3 id="_purpose_of_this_guide">20.1. Purpose of this guide</h3>
<div class="paragraph">
<p>In document provide guidelines for RainCatcher integrations by exposing common parameters and documenting performance guidelines for integrations.</p>
</div>
</div>
<div class="sect2">
<h3 id="_server_application">20.2. Server application</h3>
<div class="paragraph">
<p>Server exposes number of parameters that can be changed by adjusting server configuration. For more information see configuration
<a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/config-prod.js">config-prod.js</a></p>
</div>
<div class="sect3">
<h4 id="_mongodb">20.2.1. MongoDB</h4>
<div class="paragraph">
<p>MongoDB connection options should be configured to properly maintain connection pooling. See server side configuration.
<a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/config-prod.js">config-prod.js</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_indexes_on_the_mongodb_data">20.2.2. Indexes on the mongodb data</h4>
<div class="paragraph">
<p>If MongoDB is being used as storage for sync data, developers needs to create indexes to improve performance.</p>
</div>
<div class="paragraph">
<p>Workorder:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>id</p>
</li>
<li>
<p>assignee</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Workflow</p>
</div>
<div class="ulist">
<ul>
<li>
<p>id</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_redis_cache">20.2.3. Redis Cache</h4>
<div class="paragraph">
<p>RainCatcher using redis indirectly to store user sessions.
Please refer to official redis client options.
Redis configuration can be changed in <a href="https://github.com/feedhenry-raincatcher/raincatcher-server/blob/master/config-prod.js">config-prod.js</a> file.</p>
</div>
</div>
<div class="sect3">
<h4 id="_passport_js">20.2.4. Passport.js</h4>
<div class="paragraph">
<p>When designing authentication service on top of the Passport.js developers can choose their own user source. Passport.js integration performance will mostly depend on <code>Repository</code> implementation.
Implementation abstract from the any database layer. Developers will need to make sure that <a href="../../../api/1.0.0/auth-passport/docs/interfaces/_src_user_userrepository_.userrepository.html">Repository</a> implementation will return results without significant delays. Additional network timeouts can be provided. To provide best performance please make sure that no external network requests are made.</p>
</div>
</div>
<div class="sect3">
<h4 id="_feedhenry_sync">20.2.5. FeedHenry Sync</h4>
<div class="paragraph">
<p>FeedHenry Sync is being used by default in the mobile application to synchronize data between mobile device and server. RainCatcher provides thin layer on top of the sync framework with number of helpers that are RainCatcher specific.</p>
</div>
<div class="paragraph">
<p>Sync documentation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://developers.redhat.com/blog/2017/06/01/scaling-sync">Scaling sync blog</a></p>
</li>
<li>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_mobile_application_platform/4.4/html/server-side_developer_guide/server-side-developer-guide-using-rhmap-data-sync-framework#sync_configuration_guide">Sync configuration guide</a></p>
</li>
<li>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_mobile_application_platform/4.4/html/server-side_developer_guide/server-side-developer-guide-using-rhmap-data-sync-framework#sync-performance-scaling">Sync performance guide</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_changing_sync_frequency">Changing sync frequency</h5>
<div class="paragraph">
<p>Mobile application allows developers to change client sync frequency by modifying <a href="https://github.com/feedhenry-raincatcher/raincatcher-mobile/blob/master/src/config.json">config.json file</a></p>
</div>
<div class="paragraph">
<p>WFM implementation using only single <code>workorders</code> dataset.
We can change frequency as bellow:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "workorders": {
    "sync_frequency": 60
  }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
default 10 seconds frequency is being used on the server.
If you wish to change server frequency please follow sync documentation.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
For best performance users should keep the same frequency on the server and client.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_keycloak_sso_authentication">20.3. Keycloak/SSO authentication</h3>
<div class="paragraph">
<p>RainCatcher integrates with Keycloak/SSO using official clients.
Developers can install and configure Keycloak server for their own needs and capabilities.Application performance may depend on number of users and realms used in the solution. For more information about performance of Keycloak/SSO please refer to official documentation and blog.</p>
</div>
</div>
</div>
</div>
<h1 id="release-notes" class="sect0">Release notes</h1>
<div class="sect1">
<h2 id="_overview">21. Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RainCatcher allows you to move from paper based forms and processes into complete mobile solution.
RainCatcher connects a business back-office portal application with its fleet of mobilized employees via a mobile application.
Both mobile and portal applications are fully customizable.</p>
</div>
<div class="sect2">
<h3 id="_1_1_0_release">21.1. 1.1.0 Release</h3>
<div class="sect3">
<h4 id="_starting_the_applications">21.1.1. Starting the applications</h4>
<div class="paragraph">
<p>The <code>npm run start</code> command now runs the compiled JavaScript code as opposed to utilizing <a href="https://github.com/TypeStrong/ts-node">TypeScript Node</a> to run everything from the TypeScript sources.</p>
</div>
<div class="paragraph">
<p>The previous behavior is still achievable via <code>npm run start:ts</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_1_0_0_release">21.2. 1.0.0 Release</h3>
<div class="paragraph">
<p>RainCatcher 1.0.0 is a new product that was previously in tech preview. The Features are listed below.</p>
</div>
<div class="sect3">
<h4 id="_workflows">21.2.1. Workflows</h4>
<div class="paragraph">
<p>The ability to create customizable processes (called Workflows). Workflows are made up of Steps which can be the Packaged Steps
or can be custom Steps developed for a particular use case.</p>
</div>
</div>
<div class="sect3">
<h4 id="_workorders">21.2.2. Workorders</h4>
<div class="paragraph">
<p>The ability to process instances called Workorders. Workorders are a instance of an individual workflow.
Workorder can be assigned via the Portal Application to individual employees as a job for completion.</p>
</div>
</div>
<div class="sect3">
<h4 id="_step_generator">21.2.3. Step Generator</h4>
<div class="paragraph">
<p>Generates a Step via a CLI, the step can be customized to meet a use case.</p>
</div>
</div>
<div class="sect3">
<h4 id="_packaged_step">21.2.4. Packaged Step</h4>
<div class="paragraph">
<p>Providing predefined signature Step that can be used for any business needs.</p>
</div>
</div>
</div>
</div>
</div>
<h1 id="Contributing" class="sect0">Contributing</h1>
<div class="sect1">
<h2 id="{context}-pro-contributing-guide">22. Contributing Guide</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The instructions in this section are for developers who want to contribute to RainCatcher.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This procedure will install the latest master branch.</p>
</div>
<h3 id="_prerequisites_10" class="discrete">Prerequisites</h3>
<div class="paragraph">
<p>Ensure you have:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Node and npm installed (tested on Node 6 LTS)</p>
</li>
<li>
<p>git</p>
</li>
<li>
<p>access to <code>git@github.com:feedhenry-raincatcher/raincatcher-angularjs.git</code></p>
</li>
<li>
<p>MongoDB</p>
</li>
<li>
<p>Redis</p>
</li>
</ul>
</div>
<h3 id="{context}-cloning-the-git-repository" class="discrete">Cloning the Git Repository</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">git clone git@github.com:feedhenry-raincatcher/raincatcher-angularjs.git

cd raincatcher-angularjs</code></pre>
</div>
</div>
<h3 id="{context}-installing-angular-dependencies" class="discrete">Installing Repository Dependencies</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">npm install
npm run bootstrap</code></pre>
</div>
</div>
<h3 id="{context}-installing-core-dependencies" class="discrete">Installing Core Dependencies</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">cd ./core
npm install
npm run bootstrap</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The Core repository is automatically cloned by the command <code>npm run bootstrap</code>.
</td>
</tr>
</table>
</div>
<h3 id="{context}-starting-mongodb-and-redis" class="discrete">Starting MongoDB and Redis</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start MongoDB. For more information, see <a href="https://docs.mongodb.com/manual/tutorial/manage-mongodb-processes/#start-mongod-processes">Start MongoDB Processes</a>.</p>
</li>
<li>
<p>Start Redis. For more information, see <a href="https://redis.io/topics/quickstart#starting-redis">Starting Redis</a>.</p>
</li>
</ol>
</div>
<h3 id="{context}-starting-the-core-server" class="discrete">Starting the Core Server</h3>
<div class="paragraph">
<p>The following line runs the server application and the internal dependencies from their TypeScript sources:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">npm run start:ts</code></pre>
</div>
</div>
<div class="paragraph">
<p>To compile and run from JavaScript:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">npm run build
npm run start</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The terminal is out of use while the Core Server is running.
</td>
</tr>
</table>
</div>
<h3 id="{context}-running-the-mobile-and-portal-applications" class="discrete">Running the Mobile and Portal Applications</h3>
<div class="paragraph">
<p>Open a new terminal and navigate to the folder containing <em>raincatcher-angularjs</em>, and execute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">npm run start</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both the Mobile and Portal applications open automatically in a browser.</p>
</div>
<div class="paragraph">
<p><em>Revised on 2017-10-28 12:58:58 IST</em></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
</div>
</div>
</body>
</html>